
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../c-oop/">
      
      
        <link rel="next" href="../fortran/">
      
      
      <link rel="icon" href="../../assets/neopdf.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>C/C++ API - NeoPDF</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../custom.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/notebooks.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cc-api-example" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NeoPDF" class="md-header__button md-logo" aria-label="NeoPDF" data-md-component="logo">
      
  <img src="../../assets/neopdf.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NeoPDF
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              <i class="devicon-c-plain colored"></i> C/C++ API
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NeoPDF" class="md-nav__button md-logo" aria-label="NeoPDF" data-md-component="logo">
      
  <img src="../../assets/neopdf.svg" alt="logo">

    </a>
    NeoPDF
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development-with-pixi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development with Pixi
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design-and-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design Rationale
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-interpolation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Interpolation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli-tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI Tutorials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tmdlib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TMDlib Interface
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lhapdf_benchmark/pdfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LHAPDF Sets Benchmark
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neopdf-pyapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <i class="devicon-python-plain colored"></i> Python API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../c-oop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <i class="devicon-cplusplus-plain colored"></i> C++ OOP API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <i class="devicon-c-plain colored"></i> C/C++ API
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <i class="devicon-c-plain colored"></i> C/C++ API
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c-examples" class="md-nav__link">
    <span class="md-ellipsis">
      C Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-loading-and-evaluating-pdfs" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Loading and Evaluating PDFs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-filling-and-writing-a-neopdf-grid" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Filling and Writing a NeoPDF Grid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c-examples_1" class="md-nav__link">
    <span class="md-ellipsis">
      C++ Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C++ Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-loading-and-evaluating-pdfs_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Loading and Evaluating PDFs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-filling-and-writing-a-neopdf-grid_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Filling and Writing a NeoPDF Grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-filling-and-writing-a-neopdf-grid-with-generic-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3: Filling and Writing a NeoPDF Grid with generic Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fortran/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <i class="devicon-fortran-original colored"></i> Fortran API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mathematica/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <img src="https://cdn.simpleicons.org/wolfram/c83737" alt="Wolfram" style="height: 1em; vertical-align: -0.125em; margin-right: 0.25em;"/> Mathematica
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c-examples" class="md-nav__link">
    <span class="md-ellipsis">
      C Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-loading-and-evaluating-pdfs" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Loading and Evaluating PDFs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-filling-and-writing-a-neopdf-grid" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Filling and Writing a NeoPDF Grid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c-examples_1" class="md-nav__link">
    <span class="md-ellipsis">
      C++ Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C++ Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-loading-and-evaluating-pdfs_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Loading and Evaluating PDFs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-filling-and-writing-a-neopdf-grid_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Filling and Writing a NeoPDF Grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-filling-and-writing-a-neopdf-grid-with-generic-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3: Filling and Writing a NeoPDF Grid with generic Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cc-api-example">C/C++ API Example</h1>
<p>This example demonstrates how to use the <code>NeoPDF</code> C/C++ API to load and evaluate parton
distributions. More examples can be found in <a href="https://github.com/Radonirinaunimi/neopdf/tree/master/neopdf_capi/tests">neopdf_capi/tests</a>.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Build and install the C API as described in the <a href="../../installation/">installation guide</a>.</p>
<h2 id="c-examples">C Examples</h2>
<p>In this section, we are goinge to illustrate how to use the C/C++ API in a pure C project.</p>
<h3 id="example-1-loading-and-evaluating-pdfs">Example 1: Loading and Evaluating PDFs</h3>
<p>In this first examples, we are going to show how to load both single and multiple PDF members,
evaluate parton distributions for a given value of the momentum fraction <span class="arithmatex">\(x\)</span> and momentum
transfer <span class="arithmatex">\(Q^2\)</span>.</p>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">  1</a></span>
<span class="normal"><a href="#__codelineno-0-2">  2</a></span>
<span class="normal"><a href="#__codelineno-0-3">  3</a></span>
<span class="normal"><a href="#__codelineno-0-4">  4</a></span>
<span class="normal"><a href="#__codelineno-0-5">  5</a></span>
<span class="normal"><a href="#__codelineno-0-6">  6</a></span>
<span class="normal"><a href="#__codelineno-0-7">  7</a></span>
<span class="normal"><a href="#__codelineno-0-8">  8</a></span>
<span class="normal"><a href="#__codelineno-0-9">  9</a></span>
<span class="normal"><a href="#__codelineno-0-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-0-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;neopdf_capi.h&gt;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;assert.h&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;math.h&gt;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdbool.h&gt;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="nf">geomspace</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">stop</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">endpoint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="p">;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">log_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">start</span><span class="p">);</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">log_stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">stop</span><span class="p">);</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">log_stop</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">log_start</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">endpoint</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">num</span><span class="p">);</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">log_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">step</span><span class="p">);</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="p">}</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="kt">void</span><span class="w"> </span><span class="nf">test_single_pdf</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;=== Test Loading a Single PDF Member ===</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29"></a>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180&quot;</span><span class="p">;</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">neo_pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load</span><span class="p">(</span><span class="n">pdfname</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pids</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">-5</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">};</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">num_pids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">pids</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_x_min</span><span class="p">(</span><span class="n">neo_pdf</span><span class="p">);</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_x_max</span><span class="p">(</span><span class="n">neo_pdf</span><span class="p">);</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">q2_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_q2_min</span><span class="p">(</span><span class="n">neo_pdf</span><span class="p">);</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">q2_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_q2_max</span><span class="p">(</span><span class="n">neo_pdf</span><span class="p">);</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">num_xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">num_q2s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">geomspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span><span class="w"> </span><span class="n">x_max</span><span class="p">,</span><span class="w"> </span><span class="n">num_xs</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">q2s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">geomspace</span><span class="p">(</span><span class="n">q2_min</span><span class="p">,</span><span class="w"> </span><span class="n">q2_max</span><span class="p">,</span><span class="w"> </span><span class="n">num_q2s</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%6s %15s %15s %15s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pid&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Q2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NeoPDF&quot;</span><span class="p">);</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;----------------------------------------------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_pids</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_xs</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_q2s</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">neo_pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">xs</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="n">q2s</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">                </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%6d %15.8e %15.8e %15.8e</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">xs</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="n">q2s</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">xs</span><span class="p">);</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">q2s</span><span class="p">);</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="n">neopdf_pdf_free</span><span class="p">(</span><span class="n">neo_pdf</span><span class="p">);</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="p">}</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="kt">void</span><span class="w"> </span><span class="nf">test_all_pdf_members</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;=== Test Loading all the PDF Members ===</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180&quot;</span><span class="p">;</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="w">    </span><span class="n">NeoPDFMembers</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load_all</span><span class="p">(</span><span class="n">pdfname</span><span class="p">);</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Loaded %zu PDF members</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">;</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.65</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.65</span><span class="p">;</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Evaluating xfxQ2 for pid=%d, x=%e, Q2=%e across all members:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%8s %15s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Member&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NeoPDF&quot;</span><span class="p">);</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;-------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="w">    </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">        </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="w">        </span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%8zu %15.8e</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">        </span><span class="n">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">variance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">        </span><span class="n">variance</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mean</span><span class="p">);</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">    </span><span class="n">variance</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">std_dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">);</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Statistics across all members:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Mean: %e</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">);</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Std Dev: %e</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">std_dev</span><span class="p">);</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Relative Std Dev: %e</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">std_dev</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">mean</span><span class="p">);</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">results</span><span class="p">);</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="w">    </span><span class="n">neopdf_pdf_array_free</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">);</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="p">}</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="kt">void</span><span class="w"> </span><span class="nf">test_lazy_loading</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;=== Test Lazy Loading of PDF Members ===</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180.neopdf.lz4&quot;</span><span class="p">;</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span><span class="n">NeoPDFLazyIterator</span><span class="o">*</span><span class="w"> </span><span class="n">lazy_iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load_lazy</span><span class="p">(</span><span class="n">pdfname</span><span class="p">);</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">lazy_iter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to load lazy iterator for %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pdfname</span><span class="p">);</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Successfully loaded lazy iterator for %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pdfname</span><span class="p">);</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">;</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.65</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.65</span><span class="p">;</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Evaluating xfxQ2 for pid=%d, x=%e, Q2=%e across all members (lazily):</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%8s %15s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Member&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NeoPDF&quot;</span><span class="p">);</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;-------------------------</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">member_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">    </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">pdf</span><span class="p">;</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_lazy_iterator_next</span><span class="p">(</span><span class="n">lazy_iter</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%8d %15.8e</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">member_idx</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="w">        </span><span class="n">neopdf_pdf_free</span><span class="p">(</span><span class="n">pdf</span><span class="p">);</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">        </span><span class="n">member_idx</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="w">    </span><span class="n">neopdf_lazy_iterator_free</span><span class="p">(</span><span class="n">lazy_iter</span><span class="p">);</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Successfully iterated through all members lazily.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="p">}</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="w">    </span><span class="n">test_single_pdf</span><span class="p">();</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="w">    </span><span class="n">test_all_pdf_members</span><span class="p">();</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">    </span><span class="n">test_lazy_loading</span><span class="p">();</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="example-2-filling-and-writing-a-neopdf-grid">Example 2: Filling and Writing a NeoPDF Grid</h3>
<p>This example illustrates how to fill and write a <code>NeoPDF</code> grid using the C API. It demonstrates
the process of constructing a grid for each PDF member and serializing the collection to disk.</p>
<div class="admonition tip">
<p class="admonition-title">NOTE</p>
<p>As in the other sectioons, the following example fills the <code>NeoPDF</code> grid by re-computing
the values of the subgrids from another set. This makes it possible to explicitly check
that the filling of the grid is correct. However, this makes the codes very verbose. To
easily spot the parts that actually fills the grid, some lines are highlighted.</p>
</div>
<div class="language-c highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">  1</a></span>
<span class="normal"><a href="#__codelineno-1-2">  2</a></span>
<span class="normal"><a href="#__codelineno-1-3">  3</a></span>
<span class="normal"><a href="#__codelineno-1-4">  4</a></span>
<span class="normal"><a href="#__codelineno-1-5">  5</a></span>
<span class="normal"><a href="#__codelineno-1-6">  6</a></span>
<span class="normal"><a href="#__codelineno-1-7">  7</a></span>
<span class="normal"><a href="#__codelineno-1-8">  8</a></span>
<span class="normal"><a href="#__codelineno-1-9">  9</a></span>
<span class="normal"><a href="#__codelineno-1-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-1-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-1-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-1-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-1-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-1-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-1-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-1-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-1-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-1-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-1-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-1-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-1-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-1-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-1-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-1-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-1-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-1-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-1-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-1-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-1-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-1-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-1-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-1-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-1-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-1-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-1-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-1-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-1-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-1-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-1-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-1-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-1-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-1-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-1-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-1-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-1-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-1-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-1-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-1-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-1-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-1-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-1-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-1-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-1-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-1-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-1-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-1-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-1-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-1-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-1-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-1-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-1-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-1-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-1-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-1-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-1-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-1-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-1-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-1-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-1-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-1-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-1-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-1-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-1-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-1-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-1-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-1-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-1-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-1-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-1-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-1-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-1-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-1-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-1-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-1-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-1-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-1-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-1-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-1-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-1-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-1-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-1-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-1-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-1-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-1-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-1-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-1-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-1-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-1-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-1-100">100</a></span>
<span class="normal"><a href="#__codelineno-1-101">101</a></span>
<span class="normal"><a href="#__codelineno-1-102">102</a></span>
<span class="normal"><a href="#__codelineno-1-103">103</a></span>
<span class="normal"><a href="#__codelineno-1-104">104</a></span>
<span class="normal"><a href="#__codelineno-1-105">105</a></span>
<span class="normal"><a href="#__codelineno-1-106">106</a></span>
<span class="normal"><a href="#__codelineno-1-107">107</a></span>
<span class="normal"><a href="#__codelineno-1-108">108</a></span>
<span class="normal"><a href="#__codelineno-1-109">109</a></span>
<span class="normal"><a href="#__codelineno-1-110">110</a></span>
<span class="normal"><a href="#__codelineno-1-111">111</a></span>
<span class="normal"><a href="#__codelineno-1-112">112</a></span>
<span class="normal"><a href="#__codelineno-1-113">113</a></span>
<span class="normal"><a href="#__codelineno-1-114">114</a></span>
<span class="normal"><a href="#__codelineno-1-115">115</a></span>
<span class="normal"><a href="#__codelineno-1-116">116</a></span>
<span class="normal"><a href="#__codelineno-1-117">117</a></span>
<span class="normal"><a href="#__codelineno-1-118">118</a></span>
<span class="normal"><a href="#__codelineno-1-119">119</a></span>
<span class="normal"><a href="#__codelineno-1-120">120</a></span>
<span class="normal"><a href="#__codelineno-1-121">121</a></span>
<span class="normal"><a href="#__codelineno-1-122">122</a></span>
<span class="normal"><a href="#__codelineno-1-123">123</a></span>
<span class="normal"><a href="#__codelineno-1-124">124</a></span>
<span class="normal"><a href="#__codelineno-1-125">125</a></span>
<span class="normal"><a href="#__codelineno-1-126">126</a></span>
<span class="normal"><a href="#__codelineno-1-127">127</a></span>
<span class="normal"><a href="#__codelineno-1-128">128</a></span>
<span class="normal"><a href="#__codelineno-1-129">129</a></span>
<span class="normal"><a href="#__codelineno-1-130">130</a></span>
<span class="normal"><a href="#__codelineno-1-131">131</a></span>
<span class="normal"><a href="#__codelineno-1-132">132</a></span>
<span class="normal"><a href="#__codelineno-1-133">133</a></span>
<span class="normal"><a href="#__codelineno-1-134">134</a></span>
<span class="normal"><a href="#__codelineno-1-135">135</a></span>
<span class="normal"><a href="#__codelineno-1-136">136</a></span>
<span class="normal"><a href="#__codelineno-1-137">137</a></span>
<span class="normal"><a href="#__codelineno-1-138">138</a></span>
<span class="normal"><a href="#__codelineno-1-139">139</a></span>
<span class="normal"><a href="#__codelineno-1-140">140</a></span>
<span class="normal"><a href="#__codelineno-1-141">141</a></span>
<span class="normal"><a href="#__codelineno-1-142">142</a></span>
<span class="normal"><a href="#__codelineno-1-143">143</a></span>
<span class="normal"><a href="#__codelineno-1-144">144</a></span>
<span class="normal"><a href="#__codelineno-1-145">145</a></span>
<span class="normal"><a href="#__codelineno-1-146">146</a></span>
<span class="normal"><a href="#__codelineno-1-147">147</a></span>
<span class="normal"><a href="#__codelineno-1-148">148</a></span>
<span class="normal"><a href="#__codelineno-1-149">149</a></span>
<span class="normal"><a href="#__codelineno-1-150">150</a></span>
<span class="normal"><a href="#__codelineno-1-151">151</a></span>
<span class="normal"><a href="#__codelineno-1-152">152</a></span>
<span class="normal"><a href="#__codelineno-1-153">153</a></span>
<span class="normal"><a href="#__codelineno-1-154">154</a></span>
<span class="normal"><a href="#__codelineno-1-155">155</a></span>
<span class="normal"><a href="#__codelineno-1-156">156</a></span>
<span class="normal"><a href="#__codelineno-1-157">157</a></span>
<span class="normal"><a href="#__codelineno-1-158">158</a></span>
<span class="normal"><a href="#__codelineno-1-159">159</a></span>
<span class="normal"><a href="#__codelineno-1-160">160</a></span>
<span class="normal"><a href="#__codelineno-1-161">161</a></span>
<span class="normal"><a href="#__codelineno-1-162">162</a></span>
<span class="normal"><a href="#__codelineno-1-163">163</a></span>
<span class="normal"><a href="#__codelineno-1-164">164</a></span>
<span class="normal"><a href="#__codelineno-1-165">165</a></span>
<span class="normal"><a href="#__codelineno-1-166">166</a></span>
<span class="normal"><a href="#__codelineno-1-167">167</a></span>
<span class="normal"><a href="#__codelineno-1-168">168</a></span>
<span class="normal"><a href="#__codelineno-1-169">169</a></span>
<span class="normal"><a href="#__codelineno-1-170">170</a></span>
<span class="normal"><a href="#__codelineno-1-171">171</a></span>
<span class="normal"><a href="#__codelineno-1-172">172</a></span>
<span class="normal"><a href="#__codelineno-1-173">173</a></span>
<span class="normal"><a href="#__codelineno-1-174">174</a></span>
<span class="normal"><a href="#__codelineno-1-175">175</a></span>
<span class="normal"><a href="#__codelineno-1-176">176</a></span>
<span class="normal"><a href="#__codelineno-1-177">177</a></span>
<span class="normal"><a href="#__codelineno-1-178">178</a></span>
<span class="normal"><a href="#__codelineno-1-179">179</a></span>
<span class="normal"><a href="#__codelineno-1-180">180</a></span>
<span class="normal"><a href="#__codelineno-1-181">181</a></span>
<span class="normal"><a href="#__codelineno-1-182">182</a></span>
<span class="normal"><a href="#__codelineno-1-183">183</a></span>
<span class="normal"><a href="#__codelineno-1-184">184</a></span>
<span class="normal"><a href="#__codelineno-1-185">185</a></span>
<span class="normal"><a href="#__codelineno-1-186">186</a></span>
<span class="normal"><a href="#__codelineno-1-187">187</a></span>
<span class="normal"><a href="#__codelineno-1-188">188</a></span>
<span class="normal"><a href="#__codelineno-1-189">189</a></span>
<span class="normal"><a href="#__codelineno-1-190">190</a></span>
<span class="normal"><a href="#__codelineno-1-191">191</a></span>
<span class="normal"><a href="#__codelineno-1-192">192</a></span>
<span class="normal"><a href="#__codelineno-1-193">193</a></span>
<span class="normal"><a href="#__codelineno-1-194">194</a></span>
<span class="normal"><a href="#__codelineno-1-195">195</a></span>
<span class="normal"><a href="#__codelineno-1-196">196</a></span>
<span class="normal"><a href="#__codelineno-1-197">197</a></span>
<span class="normal"><a href="#__codelineno-1-198">198</a></span>
<span class="normal"><a href="#__codelineno-1-199">199</a></span>
<span class="normal"><a href="#__codelineno-1-200">200</a></span>
<span class="normal"><a href="#__codelineno-1-201">201</a></span>
<span class="normal"><a href="#__codelineno-1-202">202</a></span>
<span class="normal"><a href="#__codelineno-1-203">203</a></span>
<span class="normal"><a href="#__codelineno-1-204">204</a></span>
<span class="normal"><a href="#__codelineno-1-205">205</a></span>
<span class="normal"><a href="#__codelineno-1-206">206</a></span>
<span class="normal"><a href="#__codelineno-1-207">207</a></span>
<span class="normal"><a href="#__codelineno-1-208">208</a></span>
<span class="normal"><a href="#__codelineno-1-209">209</a></span>
<span class="normal"><a href="#__codelineno-1-210">210</a></span>
<span class="normal"><a href="#__codelineno-1-211">211</a></span>
<span class="normal"><a href="#__codelineno-1-212">212</a></span>
<span class="normal"><a href="#__codelineno-1-213">213</a></span>
<span class="normal"><a href="#__codelineno-1-214">214</a></span>
<span class="normal"><a href="#__codelineno-1-215">215</a></span>
<span class="normal"><a href="#__codelineno-1-216">216</a></span>
<span class="normal"><a href="#__codelineno-1-217">217</a></span>
<span class="normal"><a href="#__codelineno-1-218">218</a></span>
<span class="normal"><a href="#__codelineno-1-219">219</a></span>
<span class="normal"><a href="#__codelineno-1-220">220</a></span>
<span class="normal"><a href="#__codelineno-1-221">221</a></span>
<span class="normal"><a href="#__codelineno-1-222">222</a></span>
<span class="normal"><a href="#__codelineno-1-223">223</a></span>
<span class="normal"><a href="#__codelineno-1-224">224</a></span>
<span class="normal"><a href="#__codelineno-1-225">225</a></span>
<span class="normal"><a href="#__codelineno-1-226">226</a></span>
<span class="normal"><a href="#__codelineno-1-227">227</a></span>
<span class="normal"><a href="#__codelineno-1-228">228</a></span>
<span class="normal"><a href="#__codelineno-1-229">229</a></span>
<span class="normal"><a href="#__codelineno-1-230">230</a></span>
<span class="normal"><a href="#__codelineno-1-231">231</a></span>
<span class="normal"><a href="#__codelineno-1-232">232</a></span>
<span class="normal"><a href="#__codelineno-1-233">233</a></span>
<span class="normal"><a href="#__codelineno-1-234">234</a></span>
<span class="normal"><a href="#__codelineno-1-235">235</a></span>
<span class="normal"><a href="#__codelineno-1-236">236</a></span>
<span class="normal"><a href="#__codelineno-1-237">237</a></span>
<span class="normal"><a href="#__codelineno-1-238">238</a></span>
<span class="normal"><a href="#__codelineno-1-239">239</a></span>
<span class="normal"><a href="#__codelineno-1-240">240</a></span>
<span class="normal"><a href="#__codelineno-1-241">241</a></span>
<span class="normal"><a href="#__codelineno-1-242">242</a></span>
<span class="normal"><a href="#__codelineno-1-243">243</a></span>
<span class="normal"><a href="#__codelineno-1-244">244</a></span>
<span class="normal"><a href="#__codelineno-1-245">245</a></span>
<span class="normal"><a href="#__codelineno-1-246">246</a></span>
<span class="normal"><a href="#__codelineno-1-247">247</a></span>
<span class="normal"><a href="#__codelineno-1-248">248</a></span>
<span class="normal"><a href="#__codelineno-1-249">249</a></span>
<span class="normal"><a href="#__codelineno-1-250">250</a></span>
<span class="normal"><a href="#__codelineno-1-251">251</a></span>
<span class="normal"><a href="#__codelineno-1-252">252</a></span>
<span class="normal"><a href="#__codelineno-1-253">253</a></span>
<span class="normal"><a href="#__codelineno-1-254">254</a></span>
<span class="normal"><a href="#__codelineno-1-255">255</a></span>
<span class="normal"><a href="#__codelineno-1-256">256</a></span>
<span class="normal"><a href="#__codelineno-1-257">257</a></span>
<span class="normal"><a href="#__codelineno-1-258">258</a></span>
<span class="normal"><a href="#__codelineno-1-259">259</a></span>
<span class="normal"><a href="#__codelineno-1-260">260</a></span>
<span class="normal"><a href="#__codelineno-1-261">261</a></span>
<span class="normal"><a href="#__codelineno-1-262">262</a></span>
<span class="normal"><a href="#__codelineno-1-263">263</a></span>
<span class="normal"><a href="#__codelineno-1-264">264</a></span>
<span class="normal"><a href="#__codelineno-1-265">265</a></span>
<span class="normal"><a href="#__codelineno-1-266">266</a></span>
<span class="normal"><a href="#__codelineno-1-267">267</a></span>
<span class="normal"><a href="#__codelineno-1-268">268</a></span>
<span class="normal"><a href="#__codelineno-1-269">269</a></span>
<span class="normal"><a href="#__codelineno-1-270">270</a></span>
<span class="normal"><a href="#__codelineno-1-271">271</a></span>
<span class="normal"><a href="#__codelineno-1-272">272</a></span>
<span class="normal"><a href="#__codelineno-1-273">273</a></span>
<span class="normal"><a href="#__codelineno-1-274">274</a></span>
<span class="normal"><a href="#__codelineno-1-275">275</a></span>
<span class="normal"><a href="#__codelineno-1-276">276</a></span>
<span class="normal"><a href="#__codelineno-1-277">277</a></span>
<span class="normal"><a href="#__codelineno-1-278">278</a></span>
<span class="normal"><a href="#__codelineno-1-279">279</a></span>
<span class="normal"><a href="#__codelineno-1-280">280</a></span>
<span class="normal"><a href="#__codelineno-1-281">281</a></span>
<span class="normal"><a href="#__codelineno-1-282">282</a></span>
<span class="normal"><a href="#__codelineno-1-283">283</a></span>
<span class="normal"><a href="#__codelineno-1-284">284</a></span>
<span class="normal"><a href="#__codelineno-1-285">285</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;neopdf_capi.h&gt;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;assert.h&gt;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;math.h&gt;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdbool.h&gt;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-16</span><span class="p">;</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="k">struct</span><span class="w"> </span><span class="nc">SubgridParams</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">values</span><span class="p">;</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="p">};</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15"></a>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="c1">// Helper function to extract subgrid parameters</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="k">struct</span><span class="w"> </span><span class="nc">SubgridParams</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="w">    </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="w">    </span><span class="n">NeopdfSubgridParams</span><span class="w"> </span><span class="n">param_type</span><span class="p">,</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="p">,</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_subgrids</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="w">    </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">num_subgrids</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">size_t</span><span class="p">));</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="w">    </span><span class="n">neopdf_pdf_subgrids_shape_for_param</span><span class="p">(</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25"></a><span class="w">        </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="w">        </span><span class="n">shape</span><span class="p">,</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="w">        </span><span class="n">num_subgrids</span><span class="p">,</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="w">        </span><span class="n">param_type</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape</span><span class="p">[</span><span class="n">subgrid_idx</span><span class="p">];</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31"></a>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32"></a><span class="w">    </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="w">    </span><span class="n">neopdf_pdf_subgrids_for_param</span><span class="p">(</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34"></a><span class="w">        </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35"></a><span class="w">        </span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36"></a><span class="w">        </span><span class="n">param_type</span><span class="p">,</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37"></a><span class="w">        </span><span class="n">num_subgrids</span><span class="p">,</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38"></a><span class="w">        </span><span class="n">shape</span><span class="p">,</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39"></a><span class="w">        </span><span class="n">subgrid_idx</span>
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41"></a>
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42"></a><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">shape</span><span class="p">);</span>
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">SubgridParams</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">};</span>
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45"></a><span class="p">}</span>
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46"></a>
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47"></a><span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180&quot;</span><span class="p">;</span>
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49"></a><span class="w">    </span><span class="c1">// Load all PDF members</span>
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50"></a><span class="w">    </span><span class="n">NeoPDFMembers</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load_all</span><span class="p">(</span><span class="n">pdfname</span><span class="p">);</span>
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52"></a><span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to load any PDF members!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Loaded %zu PDF members</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56"></a>
</span><span id="__span-1-57"><a id="__codelineno-1-57" name="__codelineno-1-57"></a><span class="w">    </span><span class="c1">// Extract the PID values of the PDF set</span>
</span><span id="__span-1-58"><a id="__codelineno-1-58" name="__codelineno-1-58"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_pids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_num_pids</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span id="__span-1-59"><a id="__codelineno-1-59" name="__codelineno-1-59"></a><span class="w">    </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">pids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">num_pids</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
</span><span id="__span-1-60"><a id="__codelineno-1-60" name="__codelineno-1-60"></a><span class="w">    </span><span class="n">neopdf_pdf_pids</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">pids</span><span class="p">,</span><span class="w"> </span><span class="n">num_pids</span><span class="p">);</span>
</span><span id="__span-1-61"><a id="__codelineno-1-61" name="__codelineno-1-61"></a>
</span><span id="__span-1-62"><a id="__codelineno-1-62" name="__codelineno-1-62"></a><span class="w">    </span><span class="c1">// Extrac the number of subgrids</span>
</span><span id="__span-1-63"><a id="__codelineno-1-63" name="__codelineno-1-63"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_subgrids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_num_subgrids</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span id="__span-1-64"><a id="__codelineno-1-64" name="__codelineno-1-64"></a>
</span><span id="__span-1-65"><a id="__codelineno-1-65" name="__codelineno-1-65"></a><span class="w">    </span><span class="c1">// Create a collection</span>
</span><span id="__span-1-66"><a id="__codelineno-1-66" name="__codelineno-1-66"></a><span class="hll"><span class="w">    </span><span class="n">NeoPDFGridArrayCollection</span><span class="o">*</span><span class="w"> </span><span class="n">collection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_gridarray_collection_new</span><span class="p">();</span>
</span></span><span id="__span-1-67"><a id="__codelineno-1-67" name="__codelineno-1-67"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">collection</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-68"><a id="__codelineno-1-68" name="__codelineno-1-68"></a><span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to create grid array collection!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-1-69"><a id="__codelineno-1-69" name="__codelineno-1-69"></a><span class="w">        </span><span class="n">neopdf_pdf_array_free</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">);</span>
</span><span id="__span-1-70"><a id="__codelineno-1-70" name="__codelineno-1-70"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-1-71"><a id="__codelineno-1-71" name="__codelineno-1-71"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-72"><a id="__codelineno-1-72" name="__codelineno-1-72"></a>
</span><span id="__span-1-73"><a id="__codelineno-1-73" name="__codelineno-1-73"></a><span class="w">    </span><span class="c1">// For each member, build a grid</span>
</span><span id="__span-1-74"><a id="__codelineno-1-74" name="__codelineno-1-74"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-75"><a id="__codelineno-1-75" name="__codelineno-1-75"></a><span class="w">        </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="n">m</span><span class="p">];</span>
</span><span id="__span-1-76"><a id="__codelineno-1-76" name="__codelineno-1-76"></a><span class="hll"><span class="w">        </span><span class="n">NeoPDFGrid</span><span class="o">*</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_grid_new</span><span class="p">();</span>
</span></span><span id="__span-1-77"><a id="__codelineno-1-77" name="__codelineno-1-77"></a>
</span><span id="__span-1-78"><a id="__codelineno-1-78" name="__codelineno-1-78"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">grid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-79"><a id="__codelineno-1-79" name="__codelineno-1-79"></a><span class="w">            </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to create grid for member: %zu!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-1-80"><a id="__codelineno-1-80" name="__codelineno-1-80"></a><span class="w">            </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-1-81"><a id="__codelineno-1-81" name="__codelineno-1-81"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-1-82"><a id="__codelineno-1-82" name="__codelineno-1-82"></a>
</span><span id="__span-1-83"><a id="__codelineno-1-83" name="__codelineno-1-83"></a><span class="w">        </span><span class="c1">// Loop over the Subgrids</span>
</span><span id="__span-1-84"><a id="__codelineno-1-84" name="__codelineno-1-84"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">num_subgrids</span><span class="p">;</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-85"><a id="__codelineno-1-85" name="__codelineno-1-85"></a><span class="w">            </span><span class="c1">// Extrac the parameter values of the given subgrid</span>
</span><span id="__span-1-86"><a id="__codelineno-1-86" name="__codelineno-1-86"></a><span class="w">            </span><span class="k">struct</span><span class="w"> </span><span class="nc">SubgridParams</span><span class="w"> </span><span class="n">xs_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span>
</span><span id="__span-1-87"><a id="__codelineno-1-87" name="__codelineno-1-87"></a><span class="w">                </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-1-88"><a id="__codelineno-1-88" name="__codelineno-1-88"></a><span class="w">                </span><span class="n">NEOPDF_SUBGRID_PARAMS_MOMENTUM</span><span class="p">,</span>
</span><span id="__span-1-89"><a id="__codelineno-1-89" name="__codelineno-1-89"></a><span class="w">                </span><span class="n">subgrid_idx</span><span class="p">,</span>
</span><span id="__span-1-90"><a id="__codelineno-1-90" name="__codelineno-1-90"></a><span class="w">                </span><span class="n">num_subgrids</span>
</span><span id="__span-1-91"><a id="__codelineno-1-91" name="__codelineno-1-91"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-1-92"><a id="__codelineno-1-92" name="__codelineno-1-92"></a><span class="w">            </span><span class="k">struct</span><span class="w"> </span><span class="nc">SubgridParams</span><span class="w"> </span><span class="n">q2s_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span>
</span><span id="__span-1-93"><a id="__codelineno-1-93" name="__codelineno-1-93"></a><span class="w">                </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-1-94"><a id="__codelineno-1-94" name="__codelineno-1-94"></a><span class="w">                </span><span class="n">NEOPDF_SUBGRID_PARAMS_SCALE</span><span class="p">,</span>
</span><span id="__span-1-95"><a id="__codelineno-1-95" name="__codelineno-1-95"></a><span class="w">                </span><span class="n">subgrid_idx</span><span class="p">,</span>
</span><span id="__span-1-96"><a id="__codelineno-1-96" name="__codelineno-1-96"></a><span class="w">                </span><span class="n">num_subgrids</span>
</span><span id="__span-1-97"><a id="__codelineno-1-97" name="__codelineno-1-97"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-1-98"><a id="__codelineno-1-98" name="__codelineno-1-98"></a><span class="w">            </span><span class="k">struct</span><span class="w"> </span><span class="nc">SubgridParams</span><span class="w"> </span><span class="n">alphas_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span>
</span><span id="__span-1-99"><a id="__codelineno-1-99" name="__codelineno-1-99"></a><span class="w">                </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-1-100"><a id="__codelineno-1-100" name="__codelineno-1-100"></a><span class="w">                </span><span class="n">NEOPDF_SUBGRID_PARAMS_ALPHAS</span><span class="p">,</span>
</span><span id="__span-1-101"><a id="__codelineno-1-101" name="__codelineno-1-101"></a><span class="w">                </span><span class="n">subgrid_idx</span><span class="p">,</span>
</span><span id="__span-1-102"><a id="__codelineno-1-102" name="__codelineno-1-102"></a><span class="w">                </span><span class="n">num_subgrids</span>
</span><span id="__span-1-103"><a id="__codelineno-1-103" name="__codelineno-1-103"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-1-104"><a id="__codelineno-1-104" name="__codelineno-1-104"></a><span class="w">            </span><span class="k">struct</span><span class="w"> </span><span class="nc">SubgridParams</span><span class="w"> </span><span class="n">nucleons_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span>
</span><span id="__span-1-105"><a id="__codelineno-1-105" name="__codelineno-1-105"></a><span class="w">                </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-1-106"><a id="__codelineno-1-106" name="__codelineno-1-106"></a><span class="w">                </span><span class="n">NEOPDF_SUBGRID_PARAMS_NUCLEONS</span><span class="p">,</span>
</span><span id="__span-1-107"><a id="__codelineno-1-107" name="__codelineno-1-107"></a><span class="w">                </span><span class="n">subgrid_idx</span><span class="p">,</span>
</span><span id="__span-1-108"><a id="__codelineno-1-108" name="__codelineno-1-108"></a><span class="w">                </span><span class="n">num_subgrids</span>
</span><span id="__span-1-109"><a id="__codelineno-1-109" name="__codelineno-1-109"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-1-110"><a id="__codelineno-1-110" name="__codelineno-1-110"></a><span class="w">            </span><span class="k">struct</span><span class="w"> </span><span class="nc">SubgridParams</span><span class="w"> </span><span class="n">kts_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span>
</span><span id="__span-1-111"><a id="__codelineno-1-111" name="__codelineno-1-111"></a><span class="w">                </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-1-112"><a id="__codelineno-1-112" name="__codelineno-1-112"></a><span class="w">                </span><span class="n">NEOPDF_SUBGRID_PARAMS_KT</span><span class="p">,</span>
</span><span id="__span-1-113"><a id="__codelineno-1-113" name="__codelineno-1-113"></a><span class="w">                </span><span class="n">subgrid_idx</span><span class="p">,</span>
</span><span id="__span-1-114"><a id="__codelineno-1-114" name="__codelineno-1-114"></a><span class="w">                </span><span class="n">num_subgrids</span>
</span><span id="__span-1-115"><a id="__codelineno-1-115" name="__codelineno-1-115"></a><span class="w">            </span><span class="p">);</span>
</span><span id="__span-1-116"><a id="__codelineno-1-116" name="__codelineno-1-116"></a>
</span><span id="__span-1-117"><a id="__codelineno-1-117" name="__codelineno-1-117"></a><span class="w">            </span><span class="c1">// Extract the values</span>
</span><span id="__span-1-118"><a id="__codelineno-1-118" name="__codelineno-1-118"></a><span class="w">            </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">xs_obj</span><span class="p">.</span><span class="n">values</span><span class="p">;</span>
</span><span id="__span-1-119"><a id="__codelineno-1-119" name="__codelineno-1-119"></a><span class="w">            </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">q2s</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">q2s_obj</span><span class="p">.</span><span class="n">values</span><span class="p">;</span>
</span><span id="__span-1-120"><a id="__codelineno-1-120" name="__codelineno-1-120"></a><span class="w">            </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">alphas</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">alphas_obj</span><span class="p">.</span><span class="n">values</span><span class="p">;</span>
</span><span id="__span-1-121"><a id="__codelineno-1-121" name="__codelineno-1-121"></a><span class="w">            </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">nucleons</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">nucleons_obj</span><span class="p">.</span><span class="n">values</span><span class="p">;</span>
</span><span id="__span-1-122"><a id="__codelineno-1-122" name="__codelineno-1-122"></a><span class="w">            </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">kts</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">kts_obj</span><span class="p">.</span><span class="n">values</span><span class="p">;</span>
</span><span id="__span-1-123"><a id="__codelineno-1-123" name="__codelineno-1-123"></a>
</span><span id="__span-1-124"><a id="__codelineno-1-124" name="__codelineno-1-124"></a><span class="w">            </span><span class="c1">// Compute grid_data: [q2s][xs][flavors], instead of [nucleons][alphas][q2s][xs][flavors]</span>
</span><span id="__span-1-125"><a id="__codelineno-1-125" name="__codelineno-1-125"></a><span class="w">            </span><span class="c1">// NOTE: This assumes that there is no `A`, `kT`, and `alphas` dependence.</span>
</span><span id="__span-1-126"><a id="__codelineno-1-126" name="__codelineno-1-126"></a><span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">xs_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_obj</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
</span><span id="__span-1-127"><a id="__codelineno-1-127" name="__codelineno-1-127"></a><span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">q2s_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q2s_obj</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
</span><span id="__span-1-128"><a id="__codelineno-1-128" name="__codelineno-1-128"></a><span class="w">            </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">grid_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">xs_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">q2s_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">num_pids</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
</span><span id="__span-1-129"><a id="__codelineno-1-129" name="__codelineno-1-129"></a><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">data_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-1-130"><a id="__codelineno-1-130" name="__codelineno-1-130"></a><span class="hll"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">xi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">xs_size</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">xi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-1-131"><a id="__codelineno-1-131" name="__codelineno-1-131"></a><span class="hll"><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">qi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">qi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">q2s_size</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">qi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-1-132"><a id="__codelineno-1-132" name="__codelineno-1-132"></a><span class="hll"><span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_pids</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-1-133"><a id="__codelineno-1-133" name="__codelineno-1-133"></a><span class="hll"><span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pids</span><span class="p">[</span><span class="n">f</span><span class="p">];</span>
</span></span><span id="__span-1-134"><a id="__codelineno-1-134" name="__codelineno-1-134"></a><span class="hll"><span class="w">                        </span><span class="kt">double</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span><span class="w"> </span><span class="n">q2s</span><span class="p">[</span><span class="n">qi</span><span class="p">]);</span>
</span></span><span id="__span-1-135"><a id="__codelineno-1-135" name="__codelineno-1-135"></a><span class="hll"><span class="w">                        </span><span class="n">grid_data</span><span class="p">[</span><span class="n">data_idx</span><span class="o">++</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
</span></span><span id="__span-1-136"><a id="__codelineno-1-136" name="__codelineno-1-136"></a><span class="hll"><span class="w">                    </span><span class="p">}</span>
</span></span><span id="__span-1-137"><a id="__codelineno-1-137" name="__codelineno-1-137"></a><span class="hll"><span class="w">                </span><span class="p">}</span>
</span></span><span id="__span-1-138"><a id="__codelineno-1-138" name="__codelineno-1-138"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span></span><span id="__span-1-139"><a id="__codelineno-1-139" name="__codelineno-1-139"></a>
</span><span id="__span-1-140"><a id="__codelineno-1-140" name="__codelineno-1-140"></a><span class="w">            </span><span class="c1">// Add subgrid</span>
</span><span id="__span-1-141"><a id="__codelineno-1-141" name="__codelineno-1-141"></a><span class="hll"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">add_subgrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_grid_add_subgrid</span><span class="p">(</span>
</span></span><span id="__span-1-142"><a id="__codelineno-1-142" name="__codelineno-1-142"></a><span class="hll"><span class="w">                </span><span class="n">grid</span><span class="p">,</span>
</span></span><span id="__span-1-143"><a id="__codelineno-1-143" name="__codelineno-1-143"></a><span class="hll"><span class="w">                </span><span class="n">nucleons</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span></span><span id="__span-1-144"><a id="__codelineno-1-144" name="__codelineno-1-144"></a><span class="hll"><span class="w">                </span><span class="n">alphas</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span></span><span id="__span-1-145"><a id="__codelineno-1-145" name="__codelineno-1-145"></a><span class="hll"><span class="w">                </span><span class="n">kts</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span></span><span id="__span-1-146"><a id="__codelineno-1-146" name="__codelineno-1-146"></a><span class="hll"><span class="w">                </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">xs_size</span><span class="p">,</span>
</span></span><span id="__span-1-147"><a id="__codelineno-1-147" name="__codelineno-1-147"></a><span class="hll"><span class="w">                </span><span class="n">q2s</span><span class="p">,</span><span class="w"> </span><span class="n">q2s_size</span><span class="p">,</span>
</span></span><span id="__span-1-148"><a id="__codelineno-1-148" name="__codelineno-1-148"></a><span class="hll"><span class="w">                </span><span class="n">grid_data</span><span class="p">,</span><span class="w"> </span><span class="n">data_idx</span>
</span></span><span id="__span-1-149"><a id="__codelineno-1-149" name="__codelineno-1-149"></a><span class="hll"><span class="w">            </span><span class="p">);</span>
</span></span><span id="__span-1-150"><a id="__codelineno-1-150" name="__codelineno-1-150"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">add_subgrid</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NEOPDF_RESULT_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-151"><a id="__codelineno-1-151" name="__codelineno-1-151"></a><span class="w">                </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to add subgrid for member: %zu!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-1-152"><a id="__codelineno-1-152" name="__codelineno-1-152"></a><span class="w">                </span><span class="n">neopdf_grid_free</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
</span><span id="__span-1-153"><a id="__codelineno-1-153" name="__codelineno-1-153"></a><span class="w">                </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-1-154"><a id="__codelineno-1-154" name="__codelineno-1-154"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-1-155"><a id="__codelineno-1-155" name="__codelineno-1-155"></a><span class="w">            </span><span class="n">free</span><span class="p">(</span><span class="n">xs</span><span class="p">);</span>
</span><span id="__span-1-156"><a id="__codelineno-1-156" name="__codelineno-1-156"></a><span class="w">            </span><span class="n">free</span><span class="p">(</span><span class="n">q2s</span><span class="p">);</span>
</span><span id="__span-1-157"><a id="__codelineno-1-157" name="__codelineno-1-157"></a><span class="w">            </span><span class="n">free</span><span class="p">(</span><span class="n">alphas</span><span class="p">);</span>
</span><span id="__span-1-158"><a id="__codelineno-1-158" name="__codelineno-1-158"></a><span class="w">            </span><span class="n">free</span><span class="p">(</span><span class="n">nucleons</span><span class="p">);</span>
</span><span id="__span-1-159"><a id="__codelineno-1-159" name="__codelineno-1-159"></a><span class="w">            </span><span class="n">free</span><span class="p">(</span><span class="n">kts</span><span class="p">);</span>
</span><span id="__span-1-160"><a id="__codelineno-1-160" name="__codelineno-1-160"></a><span class="w">            </span><span class="n">free</span><span class="p">(</span><span class="n">grid_data</span><span class="p">);</span>
</span><span id="__span-1-161"><a id="__codelineno-1-161" name="__codelineno-1-161"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-1-162"><a id="__codelineno-1-162" name="__codelineno-1-162"></a>
</span><span id="__span-1-163"><a id="__codelineno-1-163" name="__codelineno-1-163"></a><span class="w">        </span><span class="c1">// Set flavor PIDs</span>
</span><span id="__span-1-164"><a id="__codelineno-1-164" name="__codelineno-1-164"></a><span class="hll"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">add_flavors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_grid_set_flavors</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="w"> </span><span class="n">pids</span><span class="p">,</span><span class="w"> </span><span class="n">num_pids</span><span class="p">);</span>
</span></span><span id="__span-1-165"><a id="__codelineno-1-165" name="__codelineno-1-165"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">add_flavors</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-166"><a id="__codelineno-1-166" name="__codelineno-1-166"></a><span class="w">            </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to set flavors for member: %zu!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-1-167"><a id="__codelineno-1-167" name="__codelineno-1-167"></a><span class="w">            </span><span class="n">neopdf_grid_free</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
</span><span id="__span-1-168"><a id="__codelineno-1-168" name="__codelineno-1-168"></a><span class="w">            </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-1-169"><a id="__codelineno-1-169" name="__codelineno-1-169"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-1-170"><a id="__codelineno-1-170" name="__codelineno-1-170"></a>
</span><span id="__span-1-171"><a id="__codelineno-1-171" name="__codelineno-1-171"></a><span class="w">        </span><span class="c1">// Add grid to collection</span>
</span><span id="__span-1-172"><a id="__codelineno-1-172" name="__codelineno-1-172"></a><span class="hll"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">add_grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_gridarray_collection_add_grid</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span><span class="w"> </span><span class="n">grid</span><span class="p">);</span>
</span></span><span id="__span-1-173"><a id="__codelineno-1-173" name="__codelineno-1-173"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">add_grid</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-174"><a id="__codelineno-1-174" name="__codelineno-1-174"></a><span class="w">            </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to add grid to collection for member: %zu!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-1-175"><a id="__codelineno-1-175" name="__codelineno-1-175"></a><span class="w">            </span><span class="n">neopdf_grid_free</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
</span><span id="__span-1-176"><a id="__codelineno-1-176" name="__codelineno-1-176"></a><span class="w">            </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-1-177"><a id="__codelineno-1-177" name="__codelineno-1-177"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-1-178"><a id="__codelineno-1-178" name="__codelineno-1-178"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Added grid for member %zu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-1-179"><a id="__codelineno-1-179" name="__codelineno-1-179"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-180"><a id="__codelineno-1-180" name="__codelineno-1-180"></a>
</span><span id="__span-1-181"><a id="__codelineno-1-181" name="__codelineno-1-181"></a><span class="w">    </span><span class="c1">// Fill the running of alphas with some random values</span>
</span><span id="__span-1-182"><a id="__codelineno-1-182" name="__codelineno-1-182"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alphas_qs</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">2.0</span><span class="p">};</span>
</span><span id="__span-1-183"><a id="__codelineno-1-183" name="__codelineno-1-183"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alphas_vals</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.118</span><span class="p">};</span>
</span><span id="__span-1-184"><a id="__codelineno-1-184" name="__codelineno-1-184"></a>
</span><span id="__span-1-185"><a id="__codelineno-1-185" name="__codelineno-1-185"></a><span class="w">    </span><span class="c1">// Extrac the ranges for the momentum x and scale Q2</span>
</span><span id="__span-1-186"><a id="__codelineno-1-186" name="__codelineno-1-186"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x_range</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span><span id="__span-1-187"><a id="__codelineno-1-187" name="__codelineno-1-187"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">q2_range</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span><span id="__span-1-188"><a id="__codelineno-1-188" name="__codelineno-1-188"></a><span class="w">    </span><span class="n">neopdf_pdf_param_range</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_MOMENTUM</span><span class="p">,</span><span class="w"> </span><span class="n">x_range</span><span class="p">);</span>
</span><span id="__span-1-189"><a id="__codelineno-1-189" name="__codelineno-1-189"></a><span class="w">    </span><span class="n">neopdf_pdf_param_range</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_SCALE</span><span class="p">,</span><span class="w"> </span><span class="n">q2_range</span><span class="p">);</span>
</span><span id="__span-1-190"><a id="__codelineno-1-190" name="__codelineno-1-190"></a>
</span><span id="__span-1-191"><a id="__codelineno-1-191" name="__codelineno-1-191"></a><span class="hll"><span class="w">    </span><span class="n">NeoPDFPhysicsParameters</span><span class="w"> </span><span class="n">phys_params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-1-192"><a id="__codelineno-1-192" name="__codelineno-1-192"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">flavor_scheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;variable&quot;</span><span class="p">,</span>
</span></span><span id="__span-1-193"><a id="__codelineno-1-193" name="__codelineno-1-193"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">order_qcd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span></span><span id="__span-1-194"><a id="__codelineno-1-194" name="__codelineno-1-194"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">alphas_order_qcd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span></span><span id="__span-1-195"><a id="__codelineno-1-195" name="__codelineno-1-195"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">80.352</span><span class="p">,</span>
</span></span><span id="__span-1-196"><a id="__codelineno-1-196" name="__codelineno-1-196"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">91.1876</span><span class="p">,</span>
</span></span><span id="__span-1-197"><a id="__codelineno-1-197" name="__codelineno-1-197"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_up</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
</span></span><span id="__span-1-198"><a id="__codelineno-1-198" name="__codelineno-1-198"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_down</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
</span></span><span id="__span-1-199"><a id="__codelineno-1-199" name="__codelineno-1-199"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_strange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
</span></span><span id="__span-1-200"><a id="__codelineno-1-200" name="__codelineno-1-200"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_charm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.51</span><span class="p">,</span>
</span></span><span id="__span-1-201"><a id="__codelineno-1-201" name="__codelineno-1-201"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.92</span><span class="p">,</span>
</span></span><span id="__span-1-202"><a id="__codelineno-1-202" name="__codelineno-1-202"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">172.5</span><span class="p">,</span>
</span></span><span id="__span-1-203"><a id="__codelineno-1-203" name="__codelineno-1-203"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">alphas_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ipol&quot;</span><span class="p">,</span>
</span></span><span id="__span-1-204"><a id="__codelineno-1-204" name="__codelineno-1-204"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">number_flavors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
</span></span><span id="__span-1-205"><a id="__codelineno-1-205" name="__codelineno-1-205"></a><span class="hll"><span class="w">    </span><span class="p">};</span>
</span></span><span id="__span-1-206"><a id="__codelineno-1-206" name="__codelineno-1-206"></a>
</span><span id="__span-1-207"><a id="__codelineno-1-207" name="__codelineno-1-207"></a><span class="hll"><span class="w">    </span><span class="n">NeoPDFMetaData</span><span class="w"> </span><span class="n">meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-1-208"><a id="__codelineno-1-208" name="__codelineno-1-208"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">set_desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180 collection&quot;</span><span class="p">,</span>
</span></span><span id="__span-1-209"><a id="__codelineno-1-209" name="__codelineno-1-209"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">set_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span></span><span id="__span-1-210"><a id="__codelineno-1-210" name="__codelineno-1-210"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">num_members</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">,</span>
</span></span><span id="__span-1-211"><a id="__codelineno-1-211" name="__codelineno-1-211"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">x_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span></span><span id="__span-1-212"><a id="__codelineno-1-212" name="__codelineno-1-212"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">x_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span></span><span id="__span-1-213"><a id="__codelineno-1-213" name="__codelineno-1-213"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">q_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">q2_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span></span><span id="__span-1-214"><a id="__codelineno-1-214" name="__codelineno-1-214"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">q_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">q2_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span></span><span id="__span-1-215"><a id="__codelineno-1-215" name="__codelineno-1-215"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">flavors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pids</span><span class="p">,</span>
</span></span><span id="__span-1-216"><a id="__codelineno-1-216" name="__codelineno-1-216"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">num_flavors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="p">)</span><span class="n">num_pids</span><span class="p">,</span>
</span></span><span id="__span-1-217"><a id="__codelineno-1-217" name="__codelineno-1-217"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;neopdf&quot;</span><span class="p">,</span>
</span></span><span id="__span-1-218"><a id="__codelineno-1-218" name="__codelineno-1-218"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">alphas_q_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alphas_qs</span><span class="p">,</span>
</span></span><span id="__span-1-219"><a id="__codelineno-1-219" name="__codelineno-1-219"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">num_alphas_q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span></span><span id="__span-1-220"><a id="__codelineno-1-220" name="__codelineno-1-220"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">alphas_vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alphas_vals</span><span class="p">,</span>
</span></span><span id="__span-1-221"><a id="__codelineno-1-221" name="__codelineno-1-221"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">num_alphas_vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span></span><span id="__span-1-222"><a id="__codelineno-1-222" name="__codelineno-1-222"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">polarised</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
</span></span><span id="__span-1-223"><a id="__codelineno-1-223" name="__codelineno-1-223"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">set_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NEOPDF_SET_TYPE_SPACE_LIKE</span><span class="p">,</span>
</span></span><span id="__span-1-224"><a id="__codelineno-1-224" name="__codelineno-1-224"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">interpolator_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NEOPDF_INTERPOLATOR_TYPE_LOG_BICUBIC</span><span class="p">,</span>
</span></span><span id="__span-1-225"><a id="__codelineno-1-225" name="__codelineno-1-225"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">error_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;replicas&quot;</span><span class="p">,</span>
</span></span><span id="__span-1-226"><a id="__codelineno-1-226" name="__codelineno-1-226"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">hadron_pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2212</span><span class="p">,</span>
</span></span><span id="__span-1-227"><a id="__codelineno-1-227" name="__codelineno-1-227"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">phys_params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">phys_params</span><span class="p">,</span>
</span></span><span id="__span-1-228"><a id="__codelineno-1-228" name="__codelineno-1-228"></a><span class="hll"><span class="w">    </span><span class="p">};</span>
</span></span><span id="__span-1-229"><a id="__codelineno-1-229" name="__codelineno-1-229"></a>
</span><span id="__span-1-230"><a id="__codelineno-1-230" name="__codelineno-1-230"></a><span class="w">    </span><span class="c1">// Check if `NEOPDF_DATA_PATH` is defined and store the Grid there.</span>
</span><span id="__span-1-231"><a id="__codelineno-1-231" name="__codelineno-1-231"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;check-xwriter.neopdf.lz4&quot;</span><span class="p">;</span>
</span><span id="__span-1-232"><a id="__codelineno-1-232" name="__codelineno-1-232"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">neopdf_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;NEOPDF_DATA_PATH&quot;</span><span class="p">);</span>
</span><span id="__span-1-233"><a id="__codelineno-1-233" name="__codelineno-1-233"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">output_path</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
</span><span id="__span-1-234"><a id="__codelineno-1-234" name="__codelineno-1-234"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">neopdf_path</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-235"><a id="__codelineno-1-235" name="__codelineno-1-235"></a><span class="w">        </span><span class="n">snprintf</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">output_path</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;%s/%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">neopdf_path</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span>
</span><span id="__span-1-236"><a id="__codelineno-1-236" name="__codelineno-1-236"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-237"><a id="__codelineno-1-237" name="__codelineno-1-237"></a><span class="w">        </span><span class="n">snprintf</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">output_path</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span>
</span><span id="__span-1-238"><a id="__codelineno-1-238" name="__codelineno-1-238"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-239"><a id="__codelineno-1-239" name="__codelineno-1-239"></a>
</span><span id="__span-1-240"><a id="__codelineno-1-240" name="__codelineno-1-240"></a><span class="w">    </span><span class="c1">// Write the PDF Grid into disk</span>
</span><span id="__span-1-241"><a id="__codelineno-1-241" name="__codelineno-1-241"></a><span class="hll"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_grid_compress</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="n">output_path</span><span class="p">);</span>
</span></span><span id="__span-1-242"><a id="__codelineno-1-242" name="__codelineno-1-242"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-243"><a id="__codelineno-1-243" name="__codelineno-1-243"></a><span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Compression failed with code %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
</span><span id="__span-1-244"><a id="__codelineno-1-244" name="__codelineno-1-244"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-245"><a id="__codelineno-1-245" name="__codelineno-1-245"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Compression succeeded!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-1-246"><a id="__codelineno-1-246" name="__codelineno-1-246"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-247"><a id="__codelineno-1-247" name="__codelineno-1-247"></a>
</span><span id="__span-1-248"><a id="__codelineno-1-248" name="__codelineno-1-248"></a><span class="w">    </span><span class="c1">// If `NEOPDF_DATA_PATH` is defined, reload the grid and check ther results.</span>
</span><span id="__span-1-249"><a id="__codelineno-1-249" name="__codelineno-1-249"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">neopdf_path</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-250"><a id="__codelineno-1-250" name="__codelineno-1-250"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">pid_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">21</span><span class="p">;</span>
</span><span id="__span-1-251"><a id="__codelineno-1-251" name="__codelineno-1-251"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">x_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-3</span><span class="p">;</span>
</span><span id="__span-1-252"><a id="__codelineno-1-252" name="__codelineno-1-252"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">q2_test1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e2</span><span class="p">;</span>
</span><span id="__span-1-253"><a id="__codelineno-1-253" name="__codelineno-1-253"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">q2_test2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e4</span><span class="p">;</span>
</span><span id="__span-1-254"><a id="__codelineno-1-254" name="__codelineno-1-254"></a>
</span><span id="__span-1-255"><a id="__codelineno-1-255" name="__codelineno-1-255"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">ref1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">pid_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">q2_test1</span><span class="p">);</span>
</span><span id="__span-1-256"><a id="__codelineno-1-256" name="__codelineno-1-256"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">ref2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">pid_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">q2_test2</span><span class="p">);</span>
</span><span id="__span-1-257"><a id="__codelineno-1-257" name="__codelineno-1-257"></a>
</span><span id="__span-1-258"><a id="__codelineno-1-258" name="__codelineno-1-258"></a><span class="w">        </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">wpdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-1-259"><a id="__codelineno-1-259" name="__codelineno-1-259"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">res1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">wpdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">q2_test1</span><span class="p">);</span>
</span><span id="__span-1-260"><a id="__codelineno-1-260" name="__codelineno-1-260"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">res2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">wpdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">q2_test2</span><span class="p">);</span>
</span><span id="__span-1-261"><a id="__codelineno-1-261" name="__codelineno-1-261"></a>
</span><span id="__span-1-262"><a id="__codelineno-1-262" name="__codelineno-1-262"></a><span class="w">        </span><span class="n">assert</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">res1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ref1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="p">);</span>
</span><span id="__span-1-263"><a id="__codelineno-1-263" name="__codelineno-1-263"></a><span class="w">        </span><span class="n">assert</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">res2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ref2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="p">);</span>
</span><span id="__span-1-264"><a id="__codelineno-1-264" name="__codelineno-1-264"></a>
</span><span id="__span-1-265"><a id="__codelineno-1-265" name="__codelineno-1-265"></a><span class="w">        </span><span class="c1">// Delete PDF object from memory</span>
</span><span id="__span-1-266"><a id="__codelineno-1-266" name="__codelineno-1-266"></a><span class="w">        </span><span class="n">neopdf_pdf_free</span><span class="p">(</span><span class="n">wpdf</span><span class="p">);</span>
</span><span id="__span-1-267"><a id="__codelineno-1-267" name="__codelineno-1-267"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-268"><a id="__codelineno-1-268" name="__codelineno-1-268"></a>
</span><span id="__span-1-269"><a id="__codelineno-1-269" name="__codelineno-1-269"></a><span class="w">    </span><span class="c1">// Clip the interpolated values to zero when negatives</span>
</span><span id="__span-1-270"><a id="__codelineno-1-270" name="__codelineno-1-270"></a><span class="w">    </span><span class="n">neopdf_pdf_set_force_positive</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">NEOPDF_FORCE_POSITIVE_CLIP_NEGATIVE</span><span class="p">);</span>
</span><span id="__span-1-271"><a id="__codelineno-1-271" name="__codelineno-1-271"></a><span class="w">    </span><span class="n">neopdf_force_positive</span><span class="w"> </span><span class="n">pos_clip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_is_force_positive</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span id="__span-1-272"><a id="__codelineno-1-272" name="__codelineno-1-272"></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">pos_clip</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NEOPDF_FORCE_POSITIVE_CLIP_NEGATIVE</span><span class="p">);</span>
</span><span id="__span-1-273"><a id="__codelineno-1-273" name="__codelineno-1-273"></a>
</span><span id="__span-1-274"><a id="__codelineno-1-274" name="__codelineno-1-274"></a><span class="w">    </span><span class="c1">// Clip the interpolated values for all the PDF members</span>
</span><span id="__span-1-275"><a id="__codelineno-1-275" name="__codelineno-1-275"></a><span class="w">    </span><span class="n">neopdf_pdf_set_force_positive_members</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neo_pdfs</span><span class="p">,</span><span class="w"> </span><span class="n">NEOPDF_FORCE_POSITIVE_CLIP_SMALL</span><span class="p">);</span>
</span><span id="__span-1-276"><a id="__codelineno-1-276" name="__codelineno-1-276"></a><span class="w">    </span><span class="n">neopdf_force_positive</span><span class="w"> </span><span class="n">clip_small</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_is_force_positive</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
</span><span id="__span-1-277"><a id="__codelineno-1-277" name="__codelineno-1-277"></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">clip_small</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NEOPDF_FORCE_POSITIVE_CLIP_SMALL</span><span class="p">);</span>
</span><span id="__span-1-278"><a id="__codelineno-1-278" name="__codelineno-1-278"></a>
</span><span id="__span-1-279"><a id="__codelineno-1-279" name="__codelineno-1-279"></a><span class="w">    </span><span class="c1">// Cleanup</span>
</span><span id="__span-1-280"><a id="__codelineno-1-280" name="__codelineno-1-280"></a><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">pids</span><span class="p">);</span>
</span><span id="__span-1-281"><a id="__codelineno-1-281" name="__codelineno-1-281"></a><span class="w">    </span><span class="n">neopdf_gridarray_collection_free</span><span class="p">(</span><span class="n">collection</span><span class="p">);</span>
</span><span id="__span-1-282"><a id="__codelineno-1-282" name="__codelineno-1-282"></a><span class="w">    </span><span class="n">neopdf_pdf_array_free</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">);</span>
</span><span id="__span-1-283"><a id="__codelineno-1-283" name="__codelineno-1-283"></a>
</span><span id="__span-1-284"><a id="__codelineno-1-284" name="__codelineno-1-284"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-1-285"><a id="__codelineno-1-285" name="__codelineno-1-285"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="c-examples_1">C++ Examples</h2>
<p>In the following section, we are going to see how to use the C/C++ API in a C++ code. For some
exampels of Object Oriented C++ codes, head over to the <a href="../c-oop/">C++ OOP section</a>.</p>
<h3 id="example-1-loading-and-evaluating-pdfs_1">Example 1: Loading and Evaluating PDFs</h3>
<p>This example demonstrates the use of the <code>NeoPDF</code> C API to load both single and multiple PDF
members, evaluate parton distributions for a range of <span class="arithmatex">\(x\)</span> and <span class="arithmatex">\(Q^2\)</span> values, and compare the
results to LHAPDF.</p>
<p><strong>Technical details:</strong></p>
<ul>
<li>The C API requires explicit memory management: objects created with <code>neopdf_pdf_load</code> or
  <code>neopdf_pdf_load_all</code> must be freed with <code>neopdf_pdf_free</code> or <code>neopdf_pdf_array_free</code> to
  avoid memory leaks.</li>
<li>The evaluation of <span class="arithmatex">\(x f(x, Q^2)\)</span> and <span class="arithmatex">\(\alpha_s(Q^2)\)</span> is performed in nested loops for each parton,
  <span class="arithmatex">\(x\)</span>, and <span class="arithmatex">\(Q^2\)</span> value. See the documentation on how to use the parallelized <code>xfxQ2s</code>.</li>
<li>The code asserts that the results from <code>NeoPDF</code> and <code>LHAPDF</code> agree within a tight tolerance.</li>
</ul>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">  1</a></span>
<span class="normal"><a href="#__codelineno-2-2">  2</a></span>
<span class="normal"><a href="#__codelineno-2-3">  3</a></span>
<span class="normal"><a href="#__codelineno-2-4">  4</a></span>
<span class="normal"><a href="#__codelineno-2-5">  5</a></span>
<span class="normal"><a href="#__codelineno-2-6">  6</a></span>
<span class="normal"><a href="#__codelineno-2-7">  7</a></span>
<span class="normal"><a href="#__codelineno-2-8">  8</a></span>
<span class="normal"><a href="#__codelineno-2-9">  9</a></span>
<span class="normal"><a href="#__codelineno-2-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-2-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-2-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-2-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-2-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-2-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-2-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-2-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-2-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-2-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-2-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-2-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-2-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-2-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-2-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-2-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-2-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-2-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-2-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-2-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-2-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-2-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-2-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-2-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-2-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-2-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-2-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-2-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-2-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-2-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-2-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-2-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-2-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-2-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-2-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-2-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-2-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-2-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-2-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-2-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-2-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-2-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-2-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-2-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-2-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-2-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-2-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-2-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-2-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-2-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-2-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-2-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-2-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-2-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-2-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-2-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-2-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-2-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-2-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-2-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-2-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-2-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-2-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-2-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-2-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-2-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-2-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-2-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-2-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-2-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-2-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-2-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-2-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-2-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-2-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-2-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-2-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-2-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-2-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-2-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-2-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-2-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-2-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-2-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-2-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-2-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-2-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-2-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-2-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-2-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-2-100">100</a></span>
<span class="normal"><a href="#__codelineno-2-101">101</a></span>
<span class="normal"><a href="#__codelineno-2-102">102</a></span>
<span class="normal"><a href="#__codelineno-2-103">103</a></span>
<span class="normal"><a href="#__codelineno-2-104">104</a></span>
<span class="normal"><a href="#__codelineno-2-105">105</a></span>
<span class="normal"><a href="#__codelineno-2-106">106</a></span>
<span class="normal"><a href="#__codelineno-2-107">107</a></span>
<span class="normal"><a href="#__codelineno-2-108">108</a></span>
<span class="normal"><a href="#__codelineno-2-109">109</a></span>
<span class="normal"><a href="#__codelineno-2-110">110</a></span>
<span class="normal"><a href="#__codelineno-2-111">111</a></span>
<span class="normal"><a href="#__codelineno-2-112">112</a></span>
<span class="normal"><a href="#__codelineno-2-113">113</a></span>
<span class="normal"><a href="#__codelineno-2-114">114</a></span>
<span class="normal"><a href="#__codelineno-2-115">115</a></span>
<span class="normal"><a href="#__codelineno-2-116">116</a></span>
<span class="normal"><a href="#__codelineno-2-117">117</a></span>
<span class="normal"><a href="#__codelineno-2-118">118</a></span>
<span class="normal"><a href="#__codelineno-2-119">119</a></span>
<span class="normal"><a href="#__codelineno-2-120">120</a></span>
<span class="normal"><a href="#__codelineno-2-121">121</a></span>
<span class="normal"><a href="#__codelineno-2-122">122</a></span>
<span class="normal"><a href="#__codelineno-2-123">123</a></span>
<span class="normal"><a href="#__codelineno-2-124">124</a></span>
<span class="normal"><a href="#__codelineno-2-125">125</a></span>
<span class="normal"><a href="#__codelineno-2-126">126</a></span>
<span class="normal"><a href="#__codelineno-2-127">127</a></span>
<span class="normal"><a href="#__codelineno-2-128">128</a></span>
<span class="normal"><a href="#__codelineno-2-129">129</a></span>
<span class="normal"><a href="#__codelineno-2-130">130</a></span>
<span class="normal"><a href="#__codelineno-2-131">131</a></span>
<span class="normal"><a href="#__codelineno-2-132">132</a></span>
<span class="normal"><a href="#__codelineno-2-133">133</a></span>
<span class="normal"><a href="#__codelineno-2-134">134</a></span>
<span class="normal"><a href="#__codelineno-2-135">135</a></span>
<span class="normal"><a href="#__codelineno-2-136">136</a></span>
<span class="normal"><a href="#__codelineno-2-137">137</a></span>
<span class="normal"><a href="#__codelineno-2-138">138</a></span>
<span class="normal"><a href="#__codelineno-2-139">139</a></span>
<span class="normal"><a href="#__codelineno-2-140">140</a></span>
<span class="normal"><a href="#__codelineno-2-141">141</a></span>
<span class="normal"><a href="#__codelineno-2-142">142</a></span>
<span class="normal"><a href="#__codelineno-2-143">143</a></span>
<span class="normal"><a href="#__codelineno-2-144">144</a></span>
<span class="normal"><a href="#__codelineno-2-145">145</a></span>
<span class="normal"><a href="#__codelineno-2-146">146</a></span>
<span class="normal"><a href="#__codelineno-2-147">147</a></span>
<span class="normal"><a href="#__codelineno-2-148">148</a></span>
<span class="normal"><a href="#__codelineno-2-149">149</a></span>
<span class="normal"><a href="#__codelineno-2-150">150</a></span>
<span class="normal"><a href="#__codelineno-2-151">151</a></span>
<span class="normal"><a href="#__codelineno-2-152">152</a></span>
<span class="normal"><a href="#__codelineno-2-153">153</a></span>
<span class="normal"><a href="#__codelineno-2-154">154</a></span>
<span class="normal"><a href="#__codelineno-2-155">155</a></span>
<span class="normal"><a href="#__codelineno-2-156">156</a></span>
<span class="normal"><a href="#__codelineno-2-157">157</a></span>
<span class="normal"><a href="#__codelineno-2-158">158</a></span>
<span class="normal"><a href="#__codelineno-2-159">159</a></span>
<span class="normal"><a href="#__codelineno-2-160">160</a></span>
<span class="normal"><a href="#__codelineno-2-161">161</a></span>
<span class="normal"><a href="#__codelineno-2-162">162</a></span>
<span class="normal"><a href="#__codelineno-2-163">163</a></span>
<span class="normal"><a href="#__codelineno-2-164">164</a></span>
<span class="normal"><a href="#__codelineno-2-165">165</a></span>
<span class="normal"><a href="#__codelineno-2-166">166</a></span>
<span class="normal"><a href="#__codelineno-2-167">167</a></span>
<span class="normal"><a href="#__codelineno-2-168">168</a></span>
<span class="normal"><a href="#__codelineno-2-169">169</a></span>
<span class="normal"><a href="#__codelineno-2-170">170</a></span>
<span class="normal"><a href="#__codelineno-2-171">171</a></span>
<span class="normal"><a href="#__codelineno-2-172">172</a></span>
<span class="normal"><a href="#__codelineno-2-173">173</a></span>
<span class="normal"><a href="#__codelineno-2-174">174</a></span>
<span class="normal"><a href="#__codelineno-2-175">175</a></span>
<span class="normal"><a href="#__codelineno-2-176">176</a></span>
<span class="normal"><a href="#__codelineno-2-177">177</a></span>
<span class="normal"><a href="#__codelineno-2-178">178</a></span>
<span class="normal"><a href="#__codelineno-2-179">179</a></span>
<span class="normal"><a href="#__codelineno-2-180">180</a></span>
<span class="normal"><a href="#__codelineno-2-181">181</a></span>
<span class="normal"><a href="#__codelineno-2-182">182</a></span>
<span class="normal"><a href="#__codelineno-2-183">183</a></span>
<span class="normal"><a href="#__codelineno-2-184">184</a></span>
<span class="normal"><a href="#__codelineno-2-185">185</a></span>
<span class="normal"><a href="#__codelineno-2-186">186</a></span>
<span class="normal"><a href="#__codelineno-2-187">187</a></span>
<span class="normal"><a href="#__codelineno-2-188">188</a></span>
<span class="normal"><a href="#__codelineno-2-189">189</a></span>
<span class="normal"><a href="#__codelineno-2-190">190</a></span>
<span class="normal"><a href="#__codelineno-2-191">191</a></span>
<span class="normal"><a href="#__codelineno-2-192">192</a></span>
<span class="normal"><a href="#__codelineno-2-193">193</a></span>
<span class="normal"><a href="#__codelineno-2-194">194</a></span>
<span class="normal"><a href="#__codelineno-2-195">195</a></span>
<span class="normal"><a href="#__codelineno-2-196">196</a></span>
<span class="normal"><a href="#__codelineno-2-197">197</a></span>
<span class="normal"><a href="#__codelineno-2-198">198</a></span>
<span class="normal"><a href="#__codelineno-2-199">199</a></span>
<span class="normal"><a href="#__codelineno-2-200">200</a></span>
<span class="normal"><a href="#__codelineno-2-201">201</a></span>
<span class="normal"><a href="#__codelineno-2-202">202</a></span>
<span class="normal"><a href="#__codelineno-2-203">203</a></span>
<span class="normal"><a href="#__codelineno-2-204">204</a></span>
<span class="normal"><a href="#__codelineno-2-205">205</a></span>
<span class="normal"><a href="#__codelineno-2-206">206</a></span>
<span class="normal"><a href="#__codelineno-2-207">207</a></span>
<span class="normal"><a href="#__codelineno-2-208">208</a></span>
<span class="normal"><a href="#__codelineno-2-209">209</a></span>
<span class="normal"><a href="#__codelineno-2-210">210</a></span>
<span class="normal"><a href="#__codelineno-2-211">211</a></span>
<span class="normal"><a href="#__codelineno-2-212">212</a></span>
<span class="normal"><a href="#__codelineno-2-213">213</a></span>
<span class="normal"><a href="#__codelineno-2-214">214</a></span>
<span class="normal"><a href="#__codelineno-2-215">215</a></span>
<span class="normal"><a href="#__codelineno-2-216">216</a></span>
<span class="normal"><a href="#__codelineno-2-217">217</a></span>
<span class="normal"><a href="#__codelineno-2-218">218</a></span>
<span class="normal"><a href="#__codelineno-2-219">219</a></span>
<span class="normal"><a href="#__codelineno-2-220">220</a></span>
<span class="normal"><a href="#__codelineno-2-221">221</a></span>
<span class="normal"><a href="#__codelineno-2-222">222</a></span>
<span class="normal"><a href="#__codelineno-2-223">223</a></span>
<span class="normal"><a href="#__codelineno-2-224">224</a></span>
<span class="normal"><a href="#__codelineno-2-225">225</a></span>
<span class="normal"><a href="#__codelineno-2-226">226</a></span>
<span class="normal"><a href="#__codelineno-2-227">227</a></span>
<span class="normal"><a href="#__codelineno-2-228">228</a></span>
<span class="normal"><a href="#__codelineno-2-229">229</a></span>
<span class="normal"><a href="#__codelineno-2-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;LHAPDF/PDF.h&gt;</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;neopdf_capi.h&gt;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cassert&gt;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cmath&gt;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdlib&gt;</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iomanip&gt;</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="o">=</span><span class="w"> </span><span class="mf">1e-16</span><span class="p">;</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">geomspace</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">stop</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="p">;</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20"></a>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">log_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">start</span><span class="p">);</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">log_stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">stop</span><span class="p">);</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">log_stop</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">log_start</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">endpoint</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">num</span><span class="p">);</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24"></a>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26"></a><span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exp</span><span class="p">(</span><span class="n">log_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">step</span><span class="p">);</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28"></a>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="p">}</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31"></a>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32"></a><span class="kt">void</span><span class="w"> </span><span class="n">test_single_pdf</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;=== Test Loading a Single PDF Member ===</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34"></a>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35"></a><span class="w">    </span><span class="c1">// disable LHAPDF banners to guarantee deterministic output</span>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36"></a><span class="w">    </span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">setVerbosity</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37"></a>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180&quot;</span><span class="p">;</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39"></a><span class="w">    </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">neo_pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load</span><span class="p">(</span><span class="n">pdfname</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40"></a><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">lha_pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">PDF</span><span class="o">&gt;</span><span class="p">(</span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">mkPDF</span><span class="p">(</span><span class="n">pdfname</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41"></a>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">-5</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">};</span>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">geomspace</span><span class="p">(</span><span class="n">lha_pdf</span><span class="o">-&gt;</span><span class="n">xMin</span><span class="p">(),</span><span class="w"> </span><span class="n">lha_pdf</span><span class="o">-&gt;</span><span class="n">xMax</span><span class="p">(),</span><span class="w"> </span><span class="mi">200</span><span class="p">);</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q2s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">geomspace</span><span class="p">(</span><span class="n">lha_pdf</span><span class="o">-&gt;</span><span class="n">q2Min</span><span class="p">(),</span><span class="w"> </span><span class="n">lha_pdf</span><span class="o">-&gt;</span><span class="n">q2Max</span><span class="p">(),</span><span class="w"> </span><span class="mi">200</span><span class="p">);</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45"></a>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46"></a><span class="w">    </span><span class="c1">// Headers of the table to print the results</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">right</span>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;pid&quot;</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;x&quot;</span>
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Q2&quot;</span>
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;LHAPDF&quot;</span>
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;NeoPDF&quot;</span>
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Rel. Diff.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="mi">81</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;-&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55"></a>
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pid</span><span class="o">:</span><span class="w"> </span><span class="n">pids</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-58"><a id="__codelineno-2-58" name="__codelineno-2-58"></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">q2</span><span class="o">:</span><span class="w"> </span><span class="n">q2s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-59"><a id="__codelineno-2-59" name="__codelineno-2-59"></a><span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lha_pdf</span><span class="o">-&gt;</span><span class="n">xfxQ2</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-2-60"><a id="__codelineno-2-60" name="__codelineno-2-60"></a><span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">neo_pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-2-61"><a id="__codelineno-2-61" name="__codelineno-2-61"></a><span class="w">                </span><span class="kt">double</span><span class="w"> </span><span class="n">reldif</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">expected</span><span class="p">;</span>
</span><span id="__span-2-62"><a id="__codelineno-2-62" name="__codelineno-2-62"></a>
</span><span id="__span-2-63"><a id="__codelineno-2-63" name="__codelineno-2-63"></a><span class="w">                </span><span class="n">assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="p">);</span>
</span><span id="__span-2-64"><a id="__codelineno-2-64" name="__codelineno-2-64"></a>
</span><span id="__span-2-65"><a id="__codelineno-2-65" name="__codelineno-2-65"></a><span class="w">                </span><span class="c1">// Print the results as a table</span>
</span><span id="__span-2-66"><a id="__codelineno-2-66" name="__codelineno-2-66"></a><span class="w">                </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">scientific</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setprecision</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-2-67"><a id="__codelineno-2-67" name="__codelineno-2-67"></a><span class="w">                    </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">right</span>
</span><span id="__span-2-68"><a id="__codelineno-2-68" name="__codelineno-2-68"></a><span class="w">                    </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">  </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pid</span>
</span><span id="__span-2-69"><a id="__codelineno-2-69" name="__codelineno-2-69"></a><span class="w">                    </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span>
</span><span id="__span-2-70"><a id="__codelineno-2-70" name="__codelineno-2-70"></a><span class="w">                    </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">q2</span>
</span><span id="__span-2-71"><a id="__codelineno-2-71" name="__codelineno-2-71"></a><span class="w">                    </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">right</span>
</span><span id="__span-2-72"><a id="__codelineno-2-72" name="__codelineno-2-72"></a><span class="w">                    </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">expected</span>
</span><span id="__span-2-73"><a id="__codelineno-2-73" name="__codelineno-2-73"></a><span class="w">                    </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">result</span>
</span><span id="__span-2-74"><a id="__codelineno-2-74" name="__codelineno-2-74"></a><span class="w">                    </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">reldif</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-75"><a id="__codelineno-2-75" name="__codelineno-2-75"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-2-76"><a id="__codelineno-2-76" name="__codelineno-2-76"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-2-77"><a id="__codelineno-2-77" name="__codelineno-2-77"></a>
</span><span id="__span-2-78"><a id="__codelineno-2-78" name="__codelineno-2-78"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-79"><a id="__codelineno-2-79" name="__codelineno-2-79"></a>
</span><span id="__span-2-80"><a id="__codelineno-2-80" name="__codelineno-2-80"></a><span class="w">    </span><span class="c1">// Delete PDF object from memory</span>
</span><span id="__span-2-81"><a id="__codelineno-2-81" name="__codelineno-2-81"></a><span class="w">    </span><span class="n">neopdf_pdf_free</span><span class="p">(</span><span class="n">neo_pdf</span><span class="p">);</span>
</span><span id="__span-2-82"><a id="__codelineno-2-82" name="__codelineno-2-82"></a><span class="p">}</span>
</span><span id="__span-2-83"><a id="__codelineno-2-83" name="__codelineno-2-83"></a>
</span><span id="__span-2-84"><a id="__codelineno-2-84" name="__codelineno-2-84"></a><span class="kt">void</span><span class="w"> </span><span class="n">test_all_pdf_members</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-85"><a id="__codelineno-2-85" name="__codelineno-2-85"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;=== Test Loading all the PDF Members ===</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-86"><a id="__codelineno-2-86" name="__codelineno-2-86"></a>
</span><span id="__span-2-87"><a id="__codelineno-2-87" name="__codelineno-2-87"></a><span class="w">    </span><span class="c1">// disable LHAPDF banners to guarantee deterministic output</span>
</span><span id="__span-2-88"><a id="__codelineno-2-88" name="__codelineno-2-88"></a><span class="w">    </span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">setVerbosity</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-2-89"><a id="__codelineno-2-89" name="__codelineno-2-89"></a>
</span><span id="__span-2-90"><a id="__codelineno-2-90" name="__codelineno-2-90"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180&quot;</span><span class="p">;</span>
</span><span id="__span-2-91"><a id="__codelineno-2-91" name="__codelineno-2-91"></a><span class="w">    </span><span class="n">NeoPDFMembers</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load_all</span><span class="p">(</span><span class="n">pdfname</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
</span><span id="__span-2-92"><a id="__codelineno-2-92" name="__codelineno-2-92"></a>
</span><span id="__span-2-93"><a id="__codelineno-2-93" name="__codelineno-2-93"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Loaded &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; PDF members</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-94"><a id="__codelineno-2-94" name="__codelineno-2-94"></a>
</span><span id="__span-2-95"><a id="__codelineno-2-95" name="__codelineno-2-95"></a><span class="w">    </span><span class="c1">// Test case: evaluate a simple point across all members</span>
</span><span id="__span-2-96"><a id="__codelineno-2-96" name="__codelineno-2-96"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-2-97"><a id="__codelineno-2-97" name="__codelineno-2-97"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">;</span>
</span><span id="__span-2-98"><a id="__codelineno-2-98" name="__codelineno-2-98"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.65</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.65</span><span class="p">;</span>
</span><span id="__span-2-99"><a id="__codelineno-2-99" name="__codelineno-2-99"></a>
</span><span id="__span-2-100"><a id="__codelineno-2-100" name="__codelineno-2-100"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Evaluating xfxQ2 for pid=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pid</span>
</span><span id="__span-2-101"><a id="__codelineno-2-101" name="__codelineno-2-101"></a><span class="w">              </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, x=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">scientific</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span>
</span><span id="__span-2-102"><a id="__codelineno-2-102" name="__codelineno-2-102"></a><span class="w">              </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, Q2=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; across all members:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-103"><a id="__codelineno-2-103" name="__codelineno-2-103"></a>
</span><span id="__span-2-104"><a id="__codelineno-2-104" name="__codelineno-2-104"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">right</span>
</span><span id="__span-2-105"><a id="__codelineno-2-105" name="__codelineno-2-105"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Member&quot;</span>
</span><span id="__span-2-106"><a id="__codelineno-2-106" name="__codelineno-2-106"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;LHAPDF&quot;</span>
</span><span id="__span-2-107"><a id="__codelineno-2-107" name="__codelineno-2-107"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;NeoPDF&quot;</span>
</span><span id="__span-2-108"><a id="__codelineno-2-108" name="__codelineno-2-108"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Rel. Diff.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-109"><a id="__codelineno-2-109" name="__codelineno-2-109"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;-&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-110"><a id="__codelineno-2-110" name="__codelineno-2-110"></a>
</span><span id="__span-2-111"><a id="__codelineno-2-111" name="__codelineno-2-111"></a><span class="w">    </span><span class="c1">// Evaluate the same point across all PDF members</span>
</span><span id="__span-2-112"><a id="__codelineno-2-112" name="__codelineno-2-112"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
</span><span id="__span-2-113"><a id="__codelineno-2-113" name="__codelineno-2-113"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-114"><a id="__codelineno-2-114" name="__codelineno-2-114"></a><span class="w">        </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span id="__span-2-115"><a id="__codelineno-2-115" name="__codelineno-2-115"></a><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">lha_pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">PDF</span><span class="o">&gt;</span><span class="p">(</span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">mkPDF</span><span class="p">(</span><span class="n">pdfname</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span>
</span><span id="__span-2-116"><a id="__codelineno-2-116" name="__codelineno-2-116"></a>
</span><span id="__span-2-117"><a id="__codelineno-2-117" name="__codelineno-2-117"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lha_pdf</span><span class="o">-&gt;</span><span class="n">xfxQ2</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-2-118"><a id="__codelineno-2-118" name="__codelineno-2-118"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-2-119"><a id="__codelineno-2-119" name="__codelineno-2-119"></a>
</span><span id="__span-2-120"><a id="__codelineno-2-120" name="__codelineno-2-120"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">reldif</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">expected</span><span class="p">;</span>
</span><span id="__span-2-121"><a id="__codelineno-2-121" name="__codelineno-2-121"></a><span class="w">        </span><span class="n">assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="p">);</span>
</span><span id="__span-2-122"><a id="__codelineno-2-122" name="__codelineno-2-122"></a><span class="w">        </span><span class="n">results</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
</span><span id="__span-2-123"><a id="__codelineno-2-123" name="__codelineno-2-123"></a>
</span><span id="__span-2-124"><a id="__codelineno-2-124" name="__codelineno-2-124"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">right</span>
</span><span id="__span-2-125"><a id="__codelineno-2-125" name="__codelineno-2-125"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span>
</span><span id="__span-2-126"><a id="__codelineno-2-126" name="__codelineno-2-126"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">scientific</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setprecision</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-2-127"><a id="__codelineno-2-127" name="__codelineno-2-127"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">expected</span>
</span><span id="__span-2-128"><a id="__codelineno-2-128" name="__codelineno-2-128"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">result</span>
</span><span id="__span-2-129"><a id="__codelineno-2-129" name="__codelineno-2-129"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">reldif</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-130"><a id="__codelineno-2-130" name="__codelineno-2-130"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-131"><a id="__codelineno-2-131" name="__codelineno-2-131"></a>
</span><span id="__span-2-132"><a id="__codelineno-2-132" name="__codelineno-2-132"></a><span class="w">    </span><span class="c1">// Calculate some statistics</span>
</span><span id="__span-2-133"><a id="__codelineno-2-133" name="__codelineno-2-133"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
</span><span id="__span-2-134"><a id="__codelineno-2-134" name="__codelineno-2-134"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">results</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-135"><a id="__codelineno-2-135" name="__codelineno-2-135"></a><span class="w">        </span><span class="n">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-2-136"><a id="__codelineno-2-136" name="__codelineno-2-136"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-137"><a id="__codelineno-2-137" name="__codelineno-2-137"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">results</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span><span id="__span-2-138"><a id="__codelineno-2-138" name="__codelineno-2-138"></a>
</span><span id="__span-2-139"><a id="__codelineno-2-139" name="__codelineno-2-139"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">variance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
</span><span id="__span-2-140"><a id="__codelineno-2-140" name="__codelineno-2-140"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">results</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-141"><a id="__codelineno-2-141" name="__codelineno-2-141"></a><span class="w">        </span><span class="n">variance</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mean</span><span class="p">);</span>
</span><span id="__span-2-142"><a id="__codelineno-2-142" name="__codelineno-2-142"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-143"><a id="__codelineno-2-143" name="__codelineno-2-143"></a><span class="w">    </span><span class="n">variance</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">results</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span><span id="__span-2-144"><a id="__codelineno-2-144" name="__codelineno-2-144"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">std_dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">);</span>
</span><span id="__span-2-145"><a id="__codelineno-2-145" name="__codelineno-2-145"></a>
</span><span id="__span-2-146"><a id="__codelineno-2-146" name="__codelineno-2-146"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Statistics across all members:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-147"><a id="__codelineno-2-147" name="__codelineno-2-147"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Mean: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">scientific</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setprecision</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-148"><a id="__codelineno-2-148" name="__codelineno-2-148"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Std Dev: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std_dev</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-149"><a id="__codelineno-2-149" name="__codelineno-2-149"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Relative Std Dev: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std_dev</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-150"><a id="__codelineno-2-150" name="__codelineno-2-150"></a>
</span><span id="__span-2-151"><a id="__codelineno-2-151" name="__codelineno-2-151"></a><span class="w">    </span><span class="c1">// Delete objects from memory.</span>
</span><span id="__span-2-152"><a id="__codelineno-2-152" name="__codelineno-2-152"></a><span class="w">    </span><span class="n">neopdf_pdf_array_free</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">);</span>
</span><span id="__span-2-153"><a id="__codelineno-2-153" name="__codelineno-2-153"></a><span class="p">}</span>
</span><span id="__span-2-154"><a id="__codelineno-2-154" name="__codelineno-2-154"></a>
</span><span id="__span-2-155"><a id="__codelineno-2-155" name="__codelineno-2-155"></a><span class="kt">void</span><span class="w"> </span><span class="n">test_lazy_loading</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-156"><a id="__codelineno-2-156" name="__codelineno-2-156"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;=== Test Lazy Loading of PDF Members ===</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-157"><a id="__codelineno-2-157" name="__codelineno-2-157"></a>
</span><span id="__span-2-158"><a id="__codelineno-2-158" name="__codelineno-2-158"></a><span class="w">    </span><span class="c1">// Disable LHAPDF banners to guarantee deterministic output</span>
</span><span id="__span-2-159"><a id="__codelineno-2-159" name="__codelineno-2-159"></a><span class="w">    </span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">setVerbosity</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-2-160"><a id="__codelineno-2-160" name="__codelineno-2-160"></a>
</span><span id="__span-2-161"><a id="__codelineno-2-161" name="__codelineno-2-161"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180&quot;</span><span class="p">;</span>
</span><span id="__span-2-162"><a id="__codelineno-2-162" name="__codelineno-2-162"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">neopdf_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;.neopdf.lz4&quot;</span><span class="p">;</span>
</span><span id="__span-2-163"><a id="__codelineno-2-163" name="__codelineno-2-163"></a><span class="w">    </span><span class="n">NeoPDFLazyIterator</span><span class="o">*</span><span class="w"> </span><span class="n">lazy_iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load_lazy</span><span class="p">(</span><span class="n">neopdf_name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
</span><span id="__span-2-164"><a id="__codelineno-2-164" name="__codelineno-2-164"></a>
</span><span id="__span-2-165"><a id="__codelineno-2-165" name="__codelineno-2-165"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">lazy_iter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-166"><a id="__codelineno-2-166" name="__codelineno-2-166"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to load lazy iterator for &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span><span id="__span-2-167"><a id="__codelineno-2-167" name="__codelineno-2-167"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-2-168"><a id="__codelineno-2-168" name="__codelineno-2-168"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-169"><a id="__codelineno-2-169" name="__codelineno-2-169"></a>
</span><span id="__span-2-170"><a id="__codelineno-2-170" name="__codelineno-2-170"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Successfully loaded lazy iterator for &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-171"><a id="__codelineno-2-171" name="__codelineno-2-171"></a>
</span><span id="__span-2-172"><a id="__codelineno-2-172" name="__codelineno-2-172"></a><span class="w">    </span><span class="c1">// Test case: evaluate a simple point across all members</span>
</span><span id="__span-2-173"><a id="__codelineno-2-173" name="__codelineno-2-173"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-2-174"><a id="__codelineno-2-174" name="__codelineno-2-174"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">;</span>
</span><span id="__span-2-175"><a id="__codelineno-2-175" name="__codelineno-2-175"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.65</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.65</span><span class="p">;</span>
</span><span id="__span-2-176"><a id="__codelineno-2-176" name="__codelineno-2-176"></a>
</span><span id="__span-2-177"><a id="__codelineno-2-177" name="__codelineno-2-177"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Evaluating xfxQ2 for pid=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">pid</span>
</span><span id="__span-2-178"><a id="__codelineno-2-178" name="__codelineno-2-178"></a><span class="w">              </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, x=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">scientific</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span>
</span><span id="__span-2-179"><a id="__codelineno-2-179" name="__codelineno-2-179"></a><span class="w">              </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, Q2=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; across all members (lazily):</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-180"><a id="__codelineno-2-180" name="__codelineno-2-180"></a>
</span><span id="__span-2-181"><a id="__codelineno-2-181" name="__codelineno-2-181"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">right</span>
</span><span id="__span-2-182"><a id="__codelineno-2-182" name="__codelineno-2-182"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Member&quot;</span>
</span><span id="__span-2-183"><a id="__codelineno-2-183" name="__codelineno-2-183"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;LHAPDF&quot;</span>
</span><span id="__span-2-184"><a id="__codelineno-2-184" name="__codelineno-2-184"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;NeoPDF&quot;</span>
</span><span id="__span-2-185"><a id="__codelineno-2-185" name="__codelineno-2-185"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Rel. Diff.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-186"><a id="__codelineno-2-186" name="__codelineno-2-186"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;-&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-187"><a id="__codelineno-2-187" name="__codelineno-2-187"></a>
</span><span id="__span-2-188"><a id="__codelineno-2-188" name="__codelineno-2-188"></a><span class="w">    </span><span class="c1">// Evaluate the same point across all PDF members</span>
</span><span id="__span-2-189"><a id="__codelineno-2-189" name="__codelineno-2-189"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
</span><span id="__span-2-190"><a id="__codelineno-2-190" name="__codelineno-2-190"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">member_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-2-191"><a id="__codelineno-2-191" name="__codelineno-2-191"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_lazy_iterator_next</span><span class="p">(</span><span class="n">lazy_iter</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-192"><a id="__codelineno-2-192" name="__codelineno-2-192"></a><span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">lha_pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">PDF</span><span class="o">&gt;</span><span class="p">(</span><span class="n">LHAPDF</span><span class="o">::</span><span class="n">mkPDF</span><span class="p">(</span><span class="n">pdfname</span><span class="p">,</span><span class="w"> </span><span class="n">member_idx</span><span class="p">));</span>
</span><span id="__span-2-193"><a id="__codelineno-2-193" name="__codelineno-2-193"></a>
</span><span id="__span-2-194"><a id="__codelineno-2-194" name="__codelineno-2-194"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lha_pdf</span><span class="o">-&gt;</span><span class="n">xfxQ2</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-2-195"><a id="__codelineno-2-195" name="__codelineno-2-195"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-2-196"><a id="__codelineno-2-196" name="__codelineno-2-196"></a>
</span><span id="__span-2-197"><a id="__codelineno-2-197" name="__codelineno-2-197"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">reldif</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">expected</span><span class="p">;</span>
</span><span id="__span-2-198"><a id="__codelineno-2-198" name="__codelineno-2-198"></a><span class="w">        </span><span class="n">assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="p">);</span>
</span><span id="__span-2-199"><a id="__codelineno-2-199" name="__codelineno-2-199"></a><span class="w">        </span><span class="n">results</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
</span><span id="__span-2-200"><a id="__codelineno-2-200" name="__codelineno-2-200"></a>
</span><span id="__span-2-201"><a id="__codelineno-2-201" name="__codelineno-2-201"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">right</span>
</span><span id="__span-2-202"><a id="__codelineno-2-202" name="__codelineno-2-202"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">member_idx</span>
</span><span id="__span-2-203"><a id="__codelineno-2-203" name="__codelineno-2-203"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">scientific</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setprecision</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-2-204"><a id="__codelineno-2-204" name="__codelineno-2-204"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">expected</span>
</span><span id="__span-2-205"><a id="__codelineno-2-205" name="__codelineno-2-205"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">result</span>
</span><span id="__span-2-206"><a id="__codelineno-2-206" name="__codelineno-2-206"></a><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">reldif</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-207"><a id="__codelineno-2-207" name="__codelineno-2-207"></a>
</span><span id="__span-2-208"><a id="__codelineno-2-208" name="__codelineno-2-208"></a><span class="w">        </span><span class="n">neopdf_pdf_free</span><span class="p">(</span><span class="n">pdf</span><span class="p">);</span><span class="w"> </span><span class="c1">// Free the individual PDF member</span>
</span><span id="__span-2-209"><a id="__codelineno-2-209" name="__codelineno-2-209"></a><span class="w">        </span><span class="n">member_idx</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-2-210"><a id="__codelineno-2-210" name="__codelineno-2-210"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-211"><a id="__codelineno-2-211" name="__codelineno-2-211"></a>
</span><span id="__span-2-212"><a id="__codelineno-2-212" name="__codelineno-2-212"></a><span class="w">    </span><span class="c1">// Free the lazy iterator</span>
</span><span id="__span-2-213"><a id="__codelineno-2-213" name="__codelineno-2-213"></a><span class="w">    </span><span class="n">neopdf_lazy_iterator_free</span><span class="p">(</span><span class="n">lazy_iter</span><span class="p">);</span>
</span><span id="__span-2-214"><a id="__codelineno-2-214" name="__codelineno-2-214"></a>
</span><span id="__span-2-215"><a id="__codelineno-2-215" name="__codelineno-2-215"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Successfully iterated through all members lazily.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-2-216"><a id="__codelineno-2-216" name="__codelineno-2-216"></a><span class="p">}</span>
</span><span id="__span-2-217"><a id="__codelineno-2-217" name="__codelineno-2-217"></a>
</span><span id="__span-2-218"><a id="__codelineno-2-218" name="__codelineno-2-218"></a>
</span><span id="__span-2-219"><a id="__codelineno-2-219" name="__codelineno-2-219"></a><span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-220"><a id="__codelineno-2-220" name="__codelineno-2-220"></a><span class="w">    </span><span class="c1">// Test loading single PDF member</span>
</span><span id="__span-2-221"><a id="__codelineno-2-221" name="__codelineno-2-221"></a><span class="w">    </span><span class="n">test_single_pdf</span><span class="p">();</span>
</span><span id="__span-2-222"><a id="__codelineno-2-222" name="__codelineno-2-222"></a>
</span><span id="__span-2-223"><a id="__codelineno-2-223" name="__codelineno-2-223"></a><span class="w">    </span><span class="c1">// Test loading all the PDF members</span>
</span><span id="__span-2-224"><a id="__codelineno-2-224" name="__codelineno-2-224"></a><span class="w">    </span><span class="n">test_all_pdf_members</span><span class="p">();</span>
</span><span id="__span-2-225"><a id="__codelineno-2-225" name="__codelineno-2-225"></a>
</span><span id="__span-2-226"><a id="__codelineno-2-226" name="__codelineno-2-226"></a><span class="w">    </span><span class="c1">// Test lazy loading of PDF members</span>
</span><span id="__span-2-227"><a id="__codelineno-2-227" name="__codelineno-2-227"></a><span class="w">    </span><span class="n">test_lazy_loading</span><span class="p">();</span>
</span><span id="__span-2-228"><a id="__codelineno-2-228" name="__codelineno-2-228"></a>
</span><span id="__span-2-229"><a id="__codelineno-2-229" name="__codelineno-2-229"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span>
</span><span id="__span-2-230"><a id="__codelineno-2-230" name="__codelineno-2-230"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="example-2-filling-and-writing-a-neopdf-grid_1">Example 2: Filling and Writing a NeoPDF Grid</h3>
<p>This example illustrates how to fill and write a <code>NeoPDF</code> grid using the C API. It demonstrates
the process of constructing a grid for each PDF member and serializing the collection to disk.</p>
<p><strong>Technical details:</strong></p>
<ul>
<li>The grid axes are defined as arrays for <span class="arithmatex">\(x\)</span>, <span class="arithmatex">\(Q^2\)</span>, parton IDs, nucleons, and <span class="arithmatex">\(\alpha_s\)</span> values.</li>
<li>The grid data is stored in a 6D array, with the layout <code>[nucleons][alphas][pids][kT][xs][q2s]</code>.</li>
<li>The <code>NeoPDFGridArrayCollection</code> manages the collection of grids and handles compression and
  serialization to disk.</li>
<li>Metadata is filled in a <code>NeoPDFMetaData</code> struct, which includes information about the set, axis
  ranges, flavors, and interpolation type. This metadata is essential for correct interpretation
  of the grid file.</li>
<li>All memory management must be handled manually; every object created must be freed with the
  appropriate function to avoid leaks.</li>
<li>The output file is compressed and written in the <code>.neopdf.lz4</code> format, suitable for use with
  <code>NeoPDF</code> tools and APIs.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">NOTE</p>
<p>The following example fills the <code>NeoPDF</code> grid by re-computing the values of the subgrids
from another set. This makes it possible to explicitly check that the filling of the grid
is correct. However, this makes the codes very verbose. To easily spot the parts that
actually fills the grid, some lines are highlighted.</p>
</div>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">  1</a></span>
<span class="normal"><a href="#__codelineno-3-2">  2</a></span>
<span class="normal"><a href="#__codelineno-3-3">  3</a></span>
<span class="normal"><a href="#__codelineno-3-4">  4</a></span>
<span class="normal"><a href="#__codelineno-3-5">  5</a></span>
<span class="normal"><a href="#__codelineno-3-6">  6</a></span>
<span class="normal"><a href="#__codelineno-3-7">  7</a></span>
<span class="normal"><a href="#__codelineno-3-8">  8</a></span>
<span class="normal"><a href="#__codelineno-3-9">  9</a></span>
<span class="normal"><a href="#__codelineno-3-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-3-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-3-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-3-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-3-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-3-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-3-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-3-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-3-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-3-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-3-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-3-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-3-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-3-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-3-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-3-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-3-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-3-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-3-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-3-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-3-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-3-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-3-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-3-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-3-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-3-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-3-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-3-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-3-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-3-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-3-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-3-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-3-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-3-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-3-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-3-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-3-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-3-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-3-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-3-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-3-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-3-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-3-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-3-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-3-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-3-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-3-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-3-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-3-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-3-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-3-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-3-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-3-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-3-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-3-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-3-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-3-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-3-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-3-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-3-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-3-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-3-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-3-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-3-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-3-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-3-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-3-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-3-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-3-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-3-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-3-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-3-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-3-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-3-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-3-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-3-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-3-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-3-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-3-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-3-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-3-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-3-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-3-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-3-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-3-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-3-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-3-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-3-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-3-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-3-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-3-100">100</a></span>
<span class="normal"><a href="#__codelineno-3-101">101</a></span>
<span class="normal"><a href="#__codelineno-3-102">102</a></span>
<span class="normal"><a href="#__codelineno-3-103">103</a></span>
<span class="normal"><a href="#__codelineno-3-104">104</a></span>
<span class="normal"><a href="#__codelineno-3-105">105</a></span>
<span class="normal"><a href="#__codelineno-3-106">106</a></span>
<span class="normal"><a href="#__codelineno-3-107">107</a></span>
<span class="normal"><a href="#__codelineno-3-108">108</a></span>
<span class="normal"><a href="#__codelineno-3-109">109</a></span>
<span class="normal"><a href="#__codelineno-3-110">110</a></span>
<span class="normal"><a href="#__codelineno-3-111">111</a></span>
<span class="normal"><a href="#__codelineno-3-112">112</a></span>
<span class="normal"><a href="#__codelineno-3-113">113</a></span>
<span class="normal"><a href="#__codelineno-3-114">114</a></span>
<span class="normal"><a href="#__codelineno-3-115">115</a></span>
<span class="normal"><a href="#__codelineno-3-116">116</a></span>
<span class="normal"><a href="#__codelineno-3-117">117</a></span>
<span class="normal"><a href="#__codelineno-3-118">118</a></span>
<span class="normal"><a href="#__codelineno-3-119">119</a></span>
<span class="normal"><a href="#__codelineno-3-120">120</a></span>
<span class="normal"><a href="#__codelineno-3-121">121</a></span>
<span class="normal"><a href="#__codelineno-3-122">122</a></span>
<span class="normal"><a href="#__codelineno-3-123">123</a></span>
<span class="normal"><a href="#__codelineno-3-124">124</a></span>
<span class="normal"><a href="#__codelineno-3-125">125</a></span>
<span class="normal"><a href="#__codelineno-3-126">126</a></span>
<span class="normal"><a href="#__codelineno-3-127">127</a></span>
<span class="normal"><a href="#__codelineno-3-128">128</a></span>
<span class="normal"><a href="#__codelineno-3-129">129</a></span>
<span class="normal"><a href="#__codelineno-3-130">130</a></span>
<span class="normal"><a href="#__codelineno-3-131">131</a></span>
<span class="normal"><a href="#__codelineno-3-132">132</a></span>
<span class="normal"><a href="#__codelineno-3-133">133</a></span>
<span class="normal"><a href="#__codelineno-3-134">134</a></span>
<span class="normal"><a href="#__codelineno-3-135">135</a></span>
<span class="normal"><a href="#__codelineno-3-136">136</a></span>
<span class="normal"><a href="#__codelineno-3-137">137</a></span>
<span class="normal"><a href="#__codelineno-3-138">138</a></span>
<span class="normal"><a href="#__codelineno-3-139">139</a></span>
<span class="normal"><a href="#__codelineno-3-140">140</a></span>
<span class="normal"><a href="#__codelineno-3-141">141</a></span>
<span class="normal"><a href="#__codelineno-3-142">142</a></span>
<span class="normal"><a href="#__codelineno-3-143">143</a></span>
<span class="normal"><a href="#__codelineno-3-144">144</a></span>
<span class="normal"><a href="#__codelineno-3-145">145</a></span>
<span class="normal"><a href="#__codelineno-3-146">146</a></span>
<span class="normal"><a href="#__codelineno-3-147">147</a></span>
<span class="normal"><a href="#__codelineno-3-148">148</a></span>
<span class="normal"><a href="#__codelineno-3-149">149</a></span>
<span class="normal"><a href="#__codelineno-3-150">150</a></span>
<span class="normal"><a href="#__codelineno-3-151">151</a></span>
<span class="normal"><a href="#__codelineno-3-152">152</a></span>
<span class="normal"><a href="#__codelineno-3-153">153</a></span>
<span class="normal"><a href="#__codelineno-3-154">154</a></span>
<span class="normal"><a href="#__codelineno-3-155">155</a></span>
<span class="normal"><a href="#__codelineno-3-156">156</a></span>
<span class="normal"><a href="#__codelineno-3-157">157</a></span>
<span class="normal"><a href="#__codelineno-3-158">158</a></span>
<span class="normal"><a href="#__codelineno-3-159">159</a></span>
<span class="normal"><a href="#__codelineno-3-160">160</a></span>
<span class="normal"><a href="#__codelineno-3-161">161</a></span>
<span class="normal"><a href="#__codelineno-3-162">162</a></span>
<span class="normal"><a href="#__codelineno-3-163">163</a></span>
<span class="normal"><a href="#__codelineno-3-164">164</a></span>
<span class="normal"><a href="#__codelineno-3-165">165</a></span>
<span class="normal"><a href="#__codelineno-3-166">166</a></span>
<span class="normal"><a href="#__codelineno-3-167">167</a></span>
<span class="normal"><a href="#__codelineno-3-168">168</a></span>
<span class="normal"><a href="#__codelineno-3-169">169</a></span>
<span class="normal"><a href="#__codelineno-3-170">170</a></span>
<span class="normal"><a href="#__codelineno-3-171">171</a></span>
<span class="normal"><a href="#__codelineno-3-172">172</a></span>
<span class="normal"><a href="#__codelineno-3-173">173</a></span>
<span class="normal"><a href="#__codelineno-3-174">174</a></span>
<span class="normal"><a href="#__codelineno-3-175">175</a></span>
<span class="normal"><a href="#__codelineno-3-176">176</a></span>
<span class="normal"><a href="#__codelineno-3-177">177</a></span>
<span class="normal"><a href="#__codelineno-3-178">178</a></span>
<span class="normal"><a href="#__codelineno-3-179">179</a></span>
<span class="normal"><a href="#__codelineno-3-180">180</a></span>
<span class="normal"><a href="#__codelineno-3-181">181</a></span>
<span class="normal"><a href="#__codelineno-3-182">182</a></span>
<span class="normal"><a href="#__codelineno-3-183">183</a></span>
<span class="normal"><a href="#__codelineno-3-184">184</a></span>
<span class="normal"><a href="#__codelineno-3-185">185</a></span>
<span class="normal"><a href="#__codelineno-3-186">186</a></span>
<span class="normal"><a href="#__codelineno-3-187">187</a></span>
<span class="normal"><a href="#__codelineno-3-188">188</a></span>
<span class="normal"><a href="#__codelineno-3-189">189</a></span>
<span class="normal"><a href="#__codelineno-3-190">190</a></span>
<span class="normal"><a href="#__codelineno-3-191">191</a></span>
<span class="normal"><a href="#__codelineno-3-192">192</a></span>
<span class="normal"><a href="#__codelineno-3-193">193</a></span>
<span class="normal"><a href="#__codelineno-3-194">194</a></span>
<span class="normal"><a href="#__codelineno-3-195">195</a></span>
<span class="normal"><a href="#__codelineno-3-196">196</a></span>
<span class="normal"><a href="#__codelineno-3-197">197</a></span>
<span class="normal"><a href="#__codelineno-3-198">198</a></span>
<span class="normal"><a href="#__codelineno-3-199">199</a></span>
<span class="normal"><a href="#__codelineno-3-200">200</a></span>
<span class="normal"><a href="#__codelineno-3-201">201</a></span>
<span class="normal"><a href="#__codelineno-3-202">202</a></span>
<span class="normal"><a href="#__codelineno-3-203">203</a></span>
<span class="normal"><a href="#__codelineno-3-204">204</a></span>
<span class="normal"><a href="#__codelineno-3-205">205</a></span>
<span class="normal"><a href="#__codelineno-3-206">206</a></span>
<span class="normal"><a href="#__codelineno-3-207">207</a></span>
<span class="normal"><a href="#__codelineno-3-208">208</a></span>
<span class="normal"><a href="#__codelineno-3-209">209</a></span>
<span class="normal"><a href="#__codelineno-3-210">210</a></span>
<span class="normal"><a href="#__codelineno-3-211">211</a></span>
<span class="normal"><a href="#__codelineno-3-212">212</a></span>
<span class="normal"><a href="#__codelineno-3-213">213</a></span>
<span class="normal"><a href="#__codelineno-3-214">214</a></span>
<span class="normal"><a href="#__codelineno-3-215">215</a></span>
<span class="normal"><a href="#__codelineno-3-216">216</a></span>
<span class="normal"><a href="#__codelineno-3-217">217</a></span>
<span class="normal"><a href="#__codelineno-3-218">218</a></span>
<span class="normal"><a href="#__codelineno-3-219">219</a></span>
<span class="normal"><a href="#__codelineno-3-220">220</a></span>
<span class="normal"><a href="#__codelineno-3-221">221</a></span>
<span class="normal"><a href="#__codelineno-3-222">222</a></span>
<span class="normal"><a href="#__codelineno-3-223">223</a></span>
<span class="normal"><a href="#__codelineno-3-224">224</a></span>
<span class="normal"><a href="#__codelineno-3-225">225</a></span>
<span class="normal"><a href="#__codelineno-3-226">226</a></span>
<span class="normal"><a href="#__codelineno-3-227">227</a></span>
<span class="normal"><a href="#__codelineno-3-228">228</a></span>
<span class="normal"><a href="#__codelineno-3-229">229</a></span>
<span class="normal"><a href="#__codelineno-3-230">230</a></span>
<span class="normal"><a href="#__codelineno-3-231">231</a></span>
<span class="normal"><a href="#__codelineno-3-232">232</a></span>
<span class="normal"><a href="#__codelineno-3-233">233</a></span>
<span class="normal"><a href="#__codelineno-3-234">234</a></span>
<span class="normal"><a href="#__codelineno-3-235">235</a></span>
<span class="normal"><a href="#__codelineno-3-236">236</a></span>
<span class="normal"><a href="#__codelineno-3-237">237</a></span>
<span class="normal"><a href="#__codelineno-3-238">238</a></span>
<span class="normal"><a href="#__codelineno-3-239">239</a></span>
<span class="normal"><a href="#__codelineno-3-240">240</a></span>
<span class="normal"><a href="#__codelineno-3-241">241</a></span>
<span class="normal"><a href="#__codelineno-3-242">242</a></span>
<span class="normal"><a href="#__codelineno-3-243">243</a></span>
<span class="normal"><a href="#__codelineno-3-244">244</a></span>
<span class="normal"><a href="#__codelineno-3-245">245</a></span>
<span class="normal"><a href="#__codelineno-3-246">246</a></span>
<span class="normal"><a href="#__codelineno-3-247">247</a></span>
<span class="normal"><a href="#__codelineno-3-248">248</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstddef&gt;</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;neopdf_capi.h&gt;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cassert&gt;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cmath&gt;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdio&gt;</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdlib&gt;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstring&gt;</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="o">=</span><span class="w"> </span><span class="mf">1e-16</span><span class="p">;</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">geomspace</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">stop</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17"></a>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="p">;</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22"></a>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">log_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">start</span><span class="p">);</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">log_stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">stop</span><span class="p">);</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">log_stop</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">log_start</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">endpoint</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">num</span><span class="p">);</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26"></a>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exp</span><span class="p">(</span><span class="n">log_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">step</span><span class="p">);</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30"></a>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32"></a><span class="p">}</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33"></a>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="c1">// Helper function to extract subgrid parameters</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36"></a><span class="w">    </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37"></a><span class="w">    </span><span class="n">NeopdfSubgridParams</span><span class="w"> </span><span class="n">param_type</span><span class="p">,</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="p">,</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_subgrids</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40"></a><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">shape</span><span class="p">(</span><span class="n">num_subgrids</span><span class="p">);</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42"></a><span class="w">    </span><span class="n">neopdf_pdf_subgrids_shape_for_param</span><span class="p">(</span>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43"></a><span class="w">        </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44"></a><span class="w">        </span><span class="n">shape</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45"></a><span class="w">        </span><span class="n">num_subgrids</span><span class="p">,</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46"></a><span class="w">        </span><span class="n">param_type</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48"></a>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">values</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="n">subgrid_idx</span><span class="p">]);</span>
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50"></a><span class="w">    </span><span class="n">neopdf_pdf_subgrids_for_param</span><span class="p">(</span>
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51"></a><span class="w">        </span><span class="n">pdf</span><span class="p">,</span>
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52"></a><span class="w">        </span><span class="n">values</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53"></a><span class="w">        </span><span class="n">param_type</span><span class="p">,</span>
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54"></a><span class="w">        </span><span class="n">num_subgrids</span><span class="p">,</span>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55"></a><span class="w">        </span><span class="n">shape</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span>
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56"></a><span class="w">        </span><span class="n">subgrid_idx</span>
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58"></a>
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">values</span><span class="p">;</span>
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60"></a><span class="p">}</span>
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61"></a>
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62"></a><span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">pdfname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180&quot;</span><span class="p">;</span>
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64"></a><span class="w">    </span><span class="c1">// Load all PDF members</span>
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65"></a><span class="w">    </span><span class="n">NeoPDFMembers</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load_all</span><span class="p">(</span><span class="n">pdfname</span><span class="p">);</span>
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to load any PDF members!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Loaded &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; PDF members</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71"></a>
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72"></a><span class="w">    </span><span class="c1">// Extract the PID values of the PDF set</span>
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_pids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_num_pids</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pids</span><span class="p">(</span><span class="n">num_pids</span><span class="p">);</span>
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75"></a><span class="w">    </span><span class="n">neopdf_pdf_pids</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">pids</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">num_pids</span><span class="p">);</span>
</span><span id="__span-3-76"><a id="__codelineno-3-76" name="__codelineno-3-76"></a>
</span><span id="__span-3-77"><a id="__codelineno-3-77" name="__codelineno-3-77"></a><span class="w">    </span><span class="c1">// Extrac the number of subgrids</span>
</span><span id="__span-3-78"><a id="__codelineno-3-78" name="__codelineno-3-78"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_subgrids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_num_subgrids</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span id="__span-3-79"><a id="__codelineno-3-79" name="__codelineno-3-79"></a>
</span><span id="__span-3-80"><a id="__codelineno-3-80" name="__codelineno-3-80"></a><span class="w">    </span><span class="c1">// Create a collection</span>
</span><span id="__span-3-81"><a id="__codelineno-3-81" name="__codelineno-3-81"></a><span class="w">    </span><span class="n">NeoPDFGridArrayCollection</span><span class="o">*</span><span class="w"> </span><span class="n">collection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_gridarray_collection_new</span><span class="p">();</span>
</span><span id="__span-3-82"><a id="__codelineno-3-82" name="__codelineno-3-82"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">collection</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-83"><a id="__codelineno-3-83" name="__codelineno-3-83"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to create grid array collection!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-84"><a id="__codelineno-3-84" name="__codelineno-3-84"></a><span class="w">        </span><span class="n">neopdf_pdf_array_free</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">);</span>
</span><span id="__span-3-85"><a id="__codelineno-3-85" name="__codelineno-3-85"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-3-86"><a id="__codelineno-3-86" name="__codelineno-3-86"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-87"><a id="__codelineno-3-87" name="__codelineno-3-87"></a>
</span><span id="__span-3-88"><a id="__codelineno-3-88" name="__codelineno-3-88"></a><span class="w">    </span><span class="c1">// For each member, build a grid</span>
</span><span id="__span-3-89"><a id="__codelineno-3-89" name="__codelineno-3-89"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-90"><a id="__codelineno-3-90" name="__codelineno-3-90"></a><span class="w">        </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="n">m</span><span class="p">];</span>
</span><span id="__span-3-91"><a id="__codelineno-3-91" name="__codelineno-3-91"></a><span class="w">        </span><span class="n">NeoPDFGrid</span><span class="o">*</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_grid_new</span><span class="p">();</span>
</span><span id="__span-3-92"><a id="__codelineno-3-92" name="__codelineno-3-92"></a>
</span><span id="__span-3-93"><a id="__codelineno-3-93" name="__codelineno-3-93"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">grid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-94"><a id="__codelineno-3-94" name="__codelineno-3-94"></a><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to create grid for member: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-95"><a id="__codelineno-3-95" name="__codelineno-3-95"></a><span class="w">            </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-3-96"><a id="__codelineno-3-96" name="__codelineno-3-96"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-3-97"><a id="__codelineno-3-97" name="__codelineno-3-97"></a>
</span><span id="__span-3-98"><a id="__codelineno-3-98" name="__codelineno-3-98"></a><span class="w">        </span><span class="c1">// Loop over the Subgrids</span>
</span><span id="__span-3-99"><a id="__codelineno-3-99" name="__codelineno-3-99"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">num_subgrids</span><span class="p">;</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-100"><a id="__codelineno-3-100" name="__codelineno-3-100"></a><span class="w">            </span><span class="c1">// Extrac the parameter values of the given subgrid</span>
</span><span id="__span-3-101"><a id="__codelineno-3-101" name="__codelineno-3-101"></a><span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_MOMENTUM</span><span class="p">,</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="p">,</span><span class="w"> </span><span class="n">num_subgrids</span><span class="p">);</span>
</span><span id="__span-3-102"><a id="__codelineno-3-102" name="__codelineno-3-102"></a><span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">q2s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_SCALE</span><span class="p">,</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="p">,</span><span class="w"> </span><span class="n">num_subgrids</span><span class="p">);</span>
</span><span id="__span-3-103"><a id="__codelineno-3-103" name="__codelineno-3-103"></a><span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">alphas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_ALPHAS</span><span class="p">,</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="p">,</span><span class="w"> </span><span class="n">num_subgrids</span><span class="p">);</span>
</span><span id="__span-3-104"><a id="__codelineno-3-104" name="__codelineno-3-104"></a><span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">nucleons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_NUCLEONS</span><span class="p">,</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="p">,</span><span class="w"> </span><span class="n">num_subgrids</span><span class="p">);</span>
</span><span id="__span-3-105"><a id="__codelineno-3-105" name="__codelineno-3-105"></a><span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">kts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extract_subgrid_params</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_KT</span><span class="p">,</span><span class="w"> </span><span class="n">subgrid_idx</span><span class="p">,</span><span class="w"> </span><span class="n">num_subgrids</span><span class="p">);</span>
</span><span id="__span-3-106"><a id="__codelineno-3-106" name="__codelineno-3-106"></a>
</span><span id="__span-3-107"><a id="__codelineno-3-107" name="__codelineno-3-107"></a><span class="w">            </span><span class="c1">// Compute grid_data: [q2s][xs][flavors], instead of [nucleons][alphas][q2s][xs][flavors]</span>
</span><span id="__span-3-108"><a id="__codelineno-3-108" name="__codelineno-3-108"></a><span class="w">            </span><span class="c1">// NOTE: This assumes that there is no &#39;A&#39; and `alphas` dependence.</span>
</span><span id="__span-3-109"><a id="__codelineno-3-109" name="__codelineno-3-109"></a><span class="w">            </span><span class="n">assert</span><span class="p">(</span><span class="n">nucleons</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-3-110"><a id="__codelineno-3-110" name="__codelineno-3-110"></a><span class="w">            </span><span class="n">assert</span><span class="p">(</span><span class="n">alphas</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-3-111"><a id="__codelineno-3-111" name="__codelineno-3-111"></a><span class="w">            </span><span class="n">assert</span><span class="p">(</span><span class="n">kts</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-3-112"><a id="__codelineno-3-112" name="__codelineno-3-112"></a><span class="hll"><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">grid_data</span><span class="p">;</span>
</span></span><span id="__span-3-113"><a id="__codelineno-3-113" name="__codelineno-3-113"></a><span class="hll"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">xi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">xs</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">xi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-3-114"><a id="__codelineno-3-114" name="__codelineno-3-114"></a><span class="hll"><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">qi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">qi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">q2s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">qi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-3-115"><a id="__codelineno-3-115" name="__codelineno-3-115"></a><span class="hll"><span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pids</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-3-116"><a id="__codelineno-3-116" name="__codelineno-3-116"></a><span class="hll"><span class="w">                        </span><span class="kt">int</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pids</span><span class="p">[</span><span class="n">f</span><span class="p">];</span>
</span></span><span id="__span-3-117"><a id="__codelineno-3-117" name="__codelineno-3-117"></a><span class="hll"><span class="w">                        </span><span class="kt">double</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span><span class="w"> </span><span class="n">q2s</span><span class="p">[</span><span class="n">qi</span><span class="p">]);</span>
</span></span><span id="__span-3-118"><a id="__codelineno-3-118" name="__codelineno-3-118"></a><span class="hll"><span class="w">                        </span><span class="n">grid_data</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
</span></span><span id="__span-3-119"><a id="__codelineno-3-119" name="__codelineno-3-119"></a><span class="hll"><span class="w">                    </span><span class="p">}</span>
</span></span><span id="__span-3-120"><a id="__codelineno-3-120" name="__codelineno-3-120"></a><span class="hll"><span class="w">                </span><span class="p">}</span>
</span></span><span id="__span-3-121"><a id="__codelineno-3-121" name="__codelineno-3-121"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span></span><span id="__span-3-122"><a id="__codelineno-3-122" name="__codelineno-3-122"></a>
</span><span id="__span-3-123"><a id="__codelineno-3-123" name="__codelineno-3-123"></a><span class="w">            </span><span class="c1">// Add subgrid</span>
</span><span id="__span-3-124"><a id="__codelineno-3-124" name="__codelineno-3-124"></a><span class="hll"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">add_subgrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_grid_add_subgrid</span><span class="p">(</span>
</span></span><span id="__span-3-125"><a id="__codelineno-3-125" name="__codelineno-3-125"></a><span class="hll"><span class="w">                </span><span class="n">grid</span><span class="p">,</span>
</span></span><span id="__span-3-126"><a id="__codelineno-3-126" name="__codelineno-3-126"></a><span class="hll"><span class="w">                </span><span class="n">nucleons</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">nucleons</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span>
</span></span><span id="__span-3-127"><a id="__codelineno-3-127" name="__codelineno-3-127"></a><span class="hll"><span class="w">                </span><span class="n">alphas</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">alphas</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span>
</span></span><span id="__span-3-128"><a id="__codelineno-3-128" name="__codelineno-3-128"></a><span class="hll"><span class="w">                </span><span class="n">kts</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">kts</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span>
</span></span><span id="__span-3-129"><a id="__codelineno-3-129" name="__codelineno-3-129"></a><span class="hll"><span class="w">                </span><span class="n">xs</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">xs</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span>
</span></span><span id="__span-3-130"><a id="__codelineno-3-130" name="__codelineno-3-130"></a><span class="hll"><span class="w">                </span><span class="n">q2s</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">q2s</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span>
</span></span><span id="__span-3-131"><a id="__codelineno-3-131" name="__codelineno-3-131"></a><span class="hll"><span class="w">                </span><span class="n">grid_data</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">grid_data</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
</span></span><span id="__span-3-132"><a id="__codelineno-3-132" name="__codelineno-3-132"></a><span class="hll"><span class="w">            </span><span class="p">);</span>
</span></span><span id="__span-3-133"><a id="__codelineno-3-133" name="__codelineno-3-133"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">add_subgrid</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NEOPDF_RESULT_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-134"><a id="__codelineno-3-134" name="__codelineno-3-134"></a><span class="w">                </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to add subgrid for member: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-135"><a id="__codelineno-3-135" name="__codelineno-3-135"></a><span class="w">                </span><span class="n">neopdf_grid_free</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
</span><span id="__span-3-136"><a id="__codelineno-3-136" name="__codelineno-3-136"></a><span class="w">                </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-3-137"><a id="__codelineno-3-137" name="__codelineno-3-137"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-3-138"><a id="__codelineno-3-138" name="__codelineno-3-138"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-3-139"><a id="__codelineno-3-139" name="__codelineno-3-139"></a>
</span><span id="__span-3-140"><a id="__codelineno-3-140" name="__codelineno-3-140"></a><span class="w">        </span><span class="c1">// Set flavor PIDs</span>
</span><span id="__span-3-141"><a id="__codelineno-3-141" name="__codelineno-3-141"></a><span class="hll"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">add_flavors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_grid_set_flavors</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="w"> </span><span class="n">pids</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">pids</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
</span></span><span id="__span-3-142"><a id="__codelineno-3-142" name="__codelineno-3-142"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">add_flavors</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-143"><a id="__codelineno-3-143" name="__codelineno-3-143"></a><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to set flavors for member: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-144"><a id="__codelineno-3-144" name="__codelineno-3-144"></a><span class="w">            </span><span class="n">neopdf_grid_free</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
</span><span id="__span-3-145"><a id="__codelineno-3-145" name="__codelineno-3-145"></a><span class="w">            </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-3-146"><a id="__codelineno-3-146" name="__codelineno-3-146"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-3-147"><a id="__codelineno-3-147" name="__codelineno-3-147"></a>
</span><span id="__span-3-148"><a id="__codelineno-3-148" name="__codelineno-3-148"></a><span class="w">        </span><span class="c1">// Add grid to collection</span>
</span><span id="__span-3-149"><a id="__codelineno-3-149" name="__codelineno-3-149"></a><span class="hll"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">add_grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_gridarray_collection_add_grid</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span><span class="w"> </span><span class="n">grid</span><span class="p">);</span>
</span></span><span id="__span-3-150"><a id="__codelineno-3-150" name="__codelineno-3-150"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">add_grid</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-151"><a id="__codelineno-3-151" name="__codelineno-3-151"></a><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Failed to add grid to collection for member: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-152"><a id="__codelineno-3-152" name="__codelineno-3-152"></a><span class="w">            </span><span class="n">neopdf_grid_free</span><span class="p">(</span><span class="n">grid</span><span class="p">);</span>
</span><span id="__span-3-153"><a id="__codelineno-3-153" name="__codelineno-3-153"></a><span class="w">            </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-3-154"><a id="__codelineno-3-154" name="__codelineno-3-154"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-3-155"><a id="__codelineno-3-155" name="__codelineno-3-155"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Added grid for member &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-156"><a id="__codelineno-3-156" name="__codelineno-3-156"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-157"><a id="__codelineno-3-157" name="__codelineno-3-157"></a>
</span><span id="__span-3-158"><a id="__codelineno-3-158" name="__codelineno-3-158"></a><span class="w">    </span><span class="c1">// Fill the running of alphas with some random values</span>
</span><span id="__span-3-159"><a id="__codelineno-3-159" name="__codelineno-3-159"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alphas_qs</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">2.0</span><span class="p">};</span>
</span><span id="__span-3-160"><a id="__codelineno-3-160" name="__codelineno-3-160"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alphas_vals</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.118</span><span class="p">};</span>
</span><span id="__span-3-161"><a id="__codelineno-3-161" name="__codelineno-3-161"></a>
</span><span id="__span-3-162"><a id="__codelineno-3-162" name="__codelineno-3-162"></a><span class="w">    </span><span class="c1">// Extrac the ranges for the momentum x and scale Q2</span>
</span><span id="__span-3-163"><a id="__codelineno-3-163" name="__codelineno-3-163"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">x_range</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-3-164"><a id="__codelineno-3-164" name="__codelineno-3-164"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">q2_range</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-3-165"><a id="__codelineno-3-165" name="__codelineno-3-165"></a><span class="w">    </span><span class="n">neopdf_pdf_param_range</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_MOMENTUM</span><span class="p">,</span><span class="w"> </span><span class="n">x_range</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
</span><span id="__span-3-166"><a id="__codelineno-3-166" name="__codelineno-3-166"></a><span class="w">    </span><span class="n">neopdf_pdf_param_range</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">NEOPDF_SUBGRID_PARAMS_SCALE</span><span class="p">,</span><span class="w"> </span><span class="n">q2_range</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
</span><span id="__span-3-167"><a id="__codelineno-3-167" name="__codelineno-3-167"></a>
</span><span id="__span-3-168"><a id="__codelineno-3-168" name="__codelineno-3-168"></a><span class="hll"><span class="w">    </span><span class="n">NeoPDFPhysicsParameters</span><span class="w"> </span><span class="n">phys_params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-3-169"><a id="__codelineno-3-169" name="__codelineno-3-169"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">flavor_scheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;variable&quot;</span><span class="p">,</span>
</span></span><span id="__span-3-170"><a id="__codelineno-3-170" name="__codelineno-3-170"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">order_qcd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span></span><span id="__span-3-171"><a id="__codelineno-3-171" name="__codelineno-3-171"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">alphas_order_qcd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span></span><span id="__span-3-172"><a id="__codelineno-3-172" name="__codelineno-3-172"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">80.352</span><span class="p">,</span>
</span></span><span id="__span-3-173"><a id="__codelineno-3-173" name="__codelineno-3-173"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">91.1876</span><span class="p">,</span>
</span></span><span id="__span-3-174"><a id="__codelineno-3-174" name="__codelineno-3-174"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_up</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
</span></span><span id="__span-3-175"><a id="__codelineno-3-175" name="__codelineno-3-175"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_down</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
</span></span><span id="__span-3-176"><a id="__codelineno-3-176" name="__codelineno-3-176"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_strange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
</span></span><span id="__span-3-177"><a id="__codelineno-3-177" name="__codelineno-3-177"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_charm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.51</span><span class="p">,</span>
</span></span><span id="__span-3-178"><a id="__codelineno-3-178" name="__codelineno-3-178"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.92</span><span class="p">,</span>
</span></span><span id="__span-3-179"><a id="__codelineno-3-179" name="__codelineno-3-179"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">m_top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">172.5</span><span class="p">,</span>
</span></span><span id="__span-3-180"><a id="__codelineno-3-180" name="__codelineno-3-180"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">alphas_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ipol&quot;</span><span class="p">,</span>
</span></span><span id="__span-3-181"><a id="__codelineno-3-181" name="__codelineno-3-181"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">number_flavors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
</span></span><span id="__span-3-182"><a id="__codelineno-3-182" name="__codelineno-3-182"></a><span class="hll"><span class="w">    </span><span class="p">};</span>
</span></span><span id="__span-3-183"><a id="__codelineno-3-183" name="__codelineno-3-183"></a>
</span><span id="__span-3-184"><a id="__codelineno-3-184" name="__codelineno-3-184"></a><span class="hll"><span class="w">    </span><span class="n">NeoPDFMetaData</span><span class="w"> </span><span class="n">meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-3-185"><a id="__codelineno-3-185" name="__codelineno-3-185"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">set_desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NNPDF40_nnlo_as_01180 collection&quot;</span><span class="p">,</span>
</span></span><span id="__span-3-186"><a id="__codelineno-3-186" name="__codelineno-3-186"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">set_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span></span><span id="__span-3-187"><a id="__codelineno-3-187" name="__codelineno-3-187"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">num_members</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">size</span><span class="p">,</span>
</span></span><span id="__span-3-188"><a id="__codelineno-3-188" name="__codelineno-3-188"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">x_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span></span><span id="__span-3-189"><a id="__codelineno-3-189" name="__codelineno-3-189"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">x_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span></span><span id="__span-3-190"><a id="__codelineno-3-190" name="__codelineno-3-190"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">q_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">q2_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span></span><span id="__span-3-191"><a id="__codelineno-3-191" name="__codelineno-3-191"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">q_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">q2_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span></span><span id="__span-3-192"><a id="__codelineno-3-192" name="__codelineno-3-192"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">flavors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pids</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span>
</span></span><span id="__span-3-193"><a id="__codelineno-3-193" name="__codelineno-3-193"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">num_flavors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="p">)</span><span class="n">pids</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span>
</span></span><span id="__span-3-194"><a id="__codelineno-3-194" name="__codelineno-3-194"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;neopdf&quot;</span><span class="p">,</span>
</span></span><span id="__span-3-195"><a id="__codelineno-3-195" name="__codelineno-3-195"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">alphas_q_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alphas_qs</span><span class="p">,</span>
</span></span><span id="__span-3-196"><a id="__codelineno-3-196" name="__codelineno-3-196"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">num_alphas_q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span></span><span id="__span-3-197"><a id="__codelineno-3-197" name="__codelineno-3-197"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">alphas_vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alphas_vals</span><span class="p">,</span>
</span></span><span id="__span-3-198"><a id="__codelineno-3-198" name="__codelineno-3-198"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">num_alphas_vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span></span><span id="__span-3-199"><a id="__codelineno-3-199" name="__codelineno-3-199"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">polarised</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
</span></span><span id="__span-3-200"><a id="__codelineno-3-200" name="__codelineno-3-200"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">set_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NEOPDF_SET_TYPE_SPACE_LIKE</span><span class="p">,</span>
</span></span><span id="__span-3-201"><a id="__codelineno-3-201" name="__codelineno-3-201"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">interpolator_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NEOPDF_INTERPOLATOR_TYPE_LOG_BICUBIC</span><span class="p">,</span>
</span></span><span id="__span-3-202"><a id="__codelineno-3-202" name="__codelineno-3-202"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">error_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;replicas&quot;</span><span class="p">,</span>
</span></span><span id="__span-3-203"><a id="__codelineno-3-203" name="__codelineno-3-203"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">hadron_pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2212</span><span class="p">,</span>
</span></span><span id="__span-3-204"><a id="__codelineno-3-204" name="__codelineno-3-204"></a><span class="hll"><span class="w">        </span><span class="p">.</span><span class="n">phys_params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">phys_params</span><span class="p">,</span>
</span></span><span id="__span-3-205"><a id="__codelineno-3-205" name="__codelineno-3-205"></a><span class="hll"><span class="w">    </span><span class="p">};</span>
</span></span><span id="__span-3-206"><a id="__codelineno-3-206" name="__codelineno-3-206"></a>
</span><span id="__span-3-207"><a id="__codelineno-3-207" name="__codelineno-3-207"></a><span class="w">    </span><span class="c1">// Check if `NEOPDF_DATA_PATH` is defined and store the Grid there.</span>
</span><span id="__span-3-208"><a id="__codelineno-3-208" name="__codelineno-3-208"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;check-writer.neopdf.lz4&quot;</span><span class="p">;</span>
</span><span id="__span-3-209"><a id="__codelineno-3-209" name="__codelineno-3-209"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">neopdf_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;NEOPDF_DATA_PATH&quot;</span><span class="p">);</span>
</span><span id="__span-3-210"><a id="__codelineno-3-210" name="__codelineno-3-210"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">output_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_path</span>
</span><span id="__span-3-211"><a id="__codelineno-3-211" name="__codelineno-3-211"></a><span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="n">neopdf_path</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="n">neopdf_path</span><span class="p">).</span><span class="n">back</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filename</span>
</span><span id="__span-3-212"><a id="__codelineno-3-212" name="__codelineno-3-212"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">filename</span><span class="p">;</span>
</span><span id="__span-3-213"><a id="__codelineno-3-213" name="__codelineno-3-213"></a>
</span><span id="__span-3-214"><a id="__codelineno-3-214" name="__codelineno-3-214"></a><span class="w">    </span><span class="c1">// Write the PDF Grid into disk</span>
</span><span id="__span-3-215"><a id="__codelineno-3-215" name="__codelineno-3-215"></a><span class="hll"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_grid_compress</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="n">output_path</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
</span></span><span id="__span-3-216"><a id="__codelineno-3-216" name="__codelineno-3-216"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-217"><a id="__codelineno-3-217" name="__codelineno-3-217"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Compression failed with code &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-218"><a id="__codelineno-3-218" name="__codelineno-3-218"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-219"><a id="__codelineno-3-219" name="__codelineno-3-219"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Compression succeeded!&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-3-220"><a id="__codelineno-3-220" name="__codelineno-3-220"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-221"><a id="__codelineno-3-221" name="__codelineno-3-221"></a>
</span><span id="__span-3-222"><a id="__codelineno-3-222" name="__codelineno-3-222"></a><span class="w">    </span><span class="c1">// If `NEOPDF_DATA_PATH` is defined, reload the grid and check ther results.</span>
</span><span id="__span-3-223"><a id="__codelineno-3-223" name="__codelineno-3-223"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">neopdf_path</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-224"><a id="__codelineno-3-224" name="__codelineno-3-224"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">pid_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">21</span><span class="p">;</span>
</span><span id="__span-3-225"><a id="__codelineno-3-225" name="__codelineno-3-225"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">x_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-3</span><span class="p">;</span>
</span><span id="__span-3-226"><a id="__codelineno-3-226" name="__codelineno-3-226"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">q2_test1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e2</span><span class="p">;</span>
</span><span id="__span-3-227"><a id="__codelineno-3-227" name="__codelineno-3-227"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">q2_test2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e4</span><span class="p">;</span>
</span><span id="__span-3-228"><a id="__codelineno-3-228" name="__codelineno-3-228"></a>
</span><span id="__span-3-229"><a id="__codelineno-3-229" name="__codelineno-3-229"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">ref1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">pid_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">q2_test1</span><span class="p">);</span>
</span><span id="__span-3-230"><a id="__codelineno-3-230" name="__codelineno-3-230"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">ref2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">.</span><span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">pid_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">q2_test2</span><span class="p">);</span>
</span><span id="__span-3-231"><a id="__codelineno-3-231" name="__codelineno-3-231"></a>
</span><span id="__span-3-232"><a id="__codelineno-3-232" name="__codelineno-3-232"></a><span class="w">        </span><span class="n">NeoPDFWrapper</span><span class="o">*</span><span class="w"> </span><span class="n">wpdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_load</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-3-233"><a id="__codelineno-3-233" name="__codelineno-3-233"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">res1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">wpdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">q2_test1</span><span class="p">);</span>
</span><span id="__span-3-234"><a id="__codelineno-3-234" name="__codelineno-3-234"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">res2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2</span><span class="p">(</span><span class="n">wpdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">q2_test2</span><span class="p">);</span>
</span><span id="__span-3-235"><a id="__codelineno-3-235" name="__codelineno-3-235"></a>
</span><span id="__span-3-236"><a id="__codelineno-3-236" name="__codelineno-3-236"></a><span class="w">        </span><span class="n">assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">res1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ref1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="p">);</span>
</span><span id="__span-3-237"><a id="__codelineno-3-237" name="__codelineno-3-237"></a><span class="w">        </span><span class="n">assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">res2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ref2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TOLERANCE</span><span class="p">);</span>
</span><span id="__span-3-238"><a id="__codelineno-3-238" name="__codelineno-3-238"></a>
</span><span id="__span-3-239"><a id="__codelineno-3-239" name="__codelineno-3-239"></a><span class="w">        </span><span class="c1">// Delete PDF object from memory</span>
</span><span id="__span-3-240"><a id="__codelineno-3-240" name="__codelineno-3-240"></a><span class="w">        </span><span class="n">neopdf_pdf_free</span><span class="p">(</span><span class="n">wpdf</span><span class="p">);</span>
</span><span id="__span-3-241"><a id="__codelineno-3-241" name="__codelineno-3-241"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-242"><a id="__codelineno-3-242" name="__codelineno-3-242"></a>
</span><span id="__span-3-243"><a id="__codelineno-3-243" name="__codelineno-3-243"></a><span class="w">    </span><span class="c1">// Cleanup</span>
</span><span id="__span-3-244"><a id="__codelineno-3-244" name="__codelineno-3-244"></a><span class="w">    </span><span class="n">neopdf_gridarray_collection_free</span><span class="p">(</span><span class="n">collection</span><span class="p">);</span>
</span><span id="__span-3-245"><a id="__codelineno-3-245" name="__codelineno-3-245"></a><span class="w">    </span><span class="n">neopdf_pdf_array_free</span><span class="p">(</span><span class="n">neo_pdfs</span><span class="p">);</span>
</span><span id="__span-3-246"><a id="__codelineno-3-246" name="__codelineno-3-246"></a>
</span><span id="__span-3-247"><a id="__codelineno-3-247" name="__codelineno-3-247"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-3-248"><a id="__codelineno-3-248" name="__codelineno-3-248"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="example-3-filling-and-writing-a-neopdf-grid-with-generic-parameters">Example 3: Filling and Writing a NeoPDF Grid with generic Parameters</h3>
<p>In the case where the PDF grid depends on more parameters, the filling of <code>grid_data</code>
in the above example simply now becomes:</p>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">grid_data</span><span class="p">;</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">ni</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ni</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nucleons</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">ni</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">asi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">asi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">alphas</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">asi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">xi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">xs</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">xi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">qi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">qi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">q2s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">qi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pids</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pids</span><span class="p">[</span><span class="n">f</span><span class="p">];</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">                    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">nucleons</span><span class="p">[</span><span class="n">ni</span><span class="p">],</span><span class="w"> </span><span class="n">alphas</span><span class="p">[</span><span class="n">asi</span><span class="p">],</span><span class="w"> </span><span class="n">xs</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span><span class="w"> </span><span class="n">q2s</span><span class="p">[</span><span class="n">qi</span><span class="p">]};</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">                    </span><span class="kt">double</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neopdf_pdf_xfxq2_nd</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">                    </span><span class="n">grid_data</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>